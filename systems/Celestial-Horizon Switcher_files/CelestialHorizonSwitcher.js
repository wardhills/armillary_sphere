(()=>{"use strict";var t={235:(t,e,i)=>{i.d(e,{Z:()=>h});var s=i(645),n=i.n(s)()((function(t){return t[1]}));n.push([t.id,"\n.cs { \n  background-color: black;\n  touch-action: none;\n}\n\n",""]);const h=n},686:(t,e,i)=>{i.d(e,{Z:()=>h});var s=i(645),n=i.n(s)()((function(t){return t[1]}));n.push([t.id,"\n\n\n.q {\n  position: fixed;\n\n  bottom: 0;\n  left: 0;\n\n  margin: 0;\n  padding: 0;\n}\n\n\n.q-inner {\n  position: absolute;\n  background-color: rgb(255, 255, 255);\n  margin: 0;\n  padding: 0;\n  box-shadow: 0 0px 8px 0 rgba(80, 80, 80, 0.5);\n\n}\n\n\n.q-openclose {\n\n  position: absolute;\n  margin: 0;\n  padding: 0;\n  border-style: none;\n  background-color: transparent;\n  cursor: pointer;\n  z-index: 1;\n}\n\n.q-nav {\n  position: relative;\n  margin: 0;\n  padding: 0;\n  border-style: none;\n  background-color: transparent;\n  cursor: pointer;\n}\n\n\n.q-openclose-svg {\n  left: 0;\n  top: 0;\n  position: absolute;\n  margin: 0;\n  padding: 0;\n\n}\n\n.q-nav-title {\n  margin: 0 10px;\n  font-weight: bold;\n}\n\n.q-content {\n  position: absolute;\n  margin: 0;\n  padding: 0 20px;\n  display: flex;\n  align-items: center;\n  justify-content: left;\n}\n\n.q-abbr {\n  position: relative;\n  margin: 0;\n  padding: 0;\n  font-family: sans-serif;\n}\n\n.q-abbr span {\n  margin: 0;\n  padding: 0;\n}\n\n\n.q-full {\n  position: relative;\n  margin: 0;\n  padding: 0;\n  font-family: sans-serif;\n}\n\n.q-full-topline {\n  position: relative;\n  margin: 0;\n  padding: 0;\n  font-family: sans-serif;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n  \n\n.q-full p {\n  margin: 10px 0;\n  padding: 0;\n  vertical-align: middle;\n}\n\n.q p {\n  margin-top: 1em;\n}\n\n\n.q-preset-btn {\n  margin: 0 1em 0 0.5em !important;\n  float: left;\n  vertical-align: middle;\n}\n\n.q {\n  font-size: 18px;\n}\n\n.q-nav-title {\n  font-size: 18px;\n}\n\n\n\n@media (max-width: 600px) {\n\n  .q {\n    font-size: 14px;\n  }\n  .q-nav-title {\n    font-size: 14px;\n  }\n\n}\n\n\n@media (min-width: 600px) and (max-width: 1000px) {\n\n  .q {\n    font-size: calc(14px + 0.01*(100vw - 600px));\n  }\n  .q-nav-title {\n    font-size: calc(14px + 0.01*(100vw - 600px));\n  }\n\n}\n\n\n@media (min-width: 1000px) {\n\n  .q {\n    font-size: 18px;\n  }\n  .q-nav-title {\n    font-size: 18px;\n  }\n\n}\n\n",""]);const h=n},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=t(e);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,s){"string"==typeof t&&(t=[[null,t,""]]);var n={};if(s)for(var h=0;h<this.length;h++){var a=this[h][0];null!=a&&(n[a]=!0)}for(var r=0;r<t.length;r++){var _=[].concat(t[r]);s&&n[_[0]]||(i&&(_[2]?_[2]="".concat(i," and ").concat(_[2]):_[2]=i),e.push(_))}},e}},379:(t,e,i)=>{var s,n=function(){var t={};return function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[e]=i}return t[e]}}(),h=[];function a(t){for(var e=-1,i=0;i<h.length;i++)if(h[i].identifier===t){e=i;break}return e}function r(t,e){for(var i={},s=[],n=0;n<t.length;n++){var r=t[n],_=e.base?r[0]+e.base:r[0],o=i[_]||0,l="".concat(_," ").concat(o);i[_]=o+1;var d=a(l),p={css:r[1],media:r[2],sourceMap:r[3]};-1!==d?(h[d].references++,h[d].updater(p)):h.push({identifier:l,updater:b(p,e),references:1}),s.push(l)}return s}function _(t){var e=document.createElement("style"),s=t.attributes||{};if(void 0===s.nonce){var h=i.nc;h&&(s.nonce=h)}if(Object.keys(s).forEach((function(t){e.setAttribute(t,s[t])})),"function"==typeof t.insert)t.insert(e);else{var a=n(t.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(e)}return e}var o,l=(o=[],function(t,e){return o[t]=e,o.filter(Boolean).join("\n")});function d(t,e,i,s){var n=i?"":s.media?"@media ".concat(s.media," {").concat(s.css,"}"):s.css;if(t.styleSheet)t.styleSheet.cssText=l(e,n);else{var h=document.createTextNode(n),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(h,a[e]):t.appendChild(h)}}function p(t,e,i){var s=i.css,n=i.media,h=i.sourceMap;if(n?t.setAttribute("media",n):t.removeAttribute("media"),h&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(h))))," */")),t.styleSheet)t.styleSheet.cssText=s;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(s))}}var u=null,c=0;function b(t,e){var i,s,n;if(e.singleton){var h=c++;i=u||(u=_(e)),s=d.bind(null,i,h,!1),n=d.bind(null,i,h,!0)}else i=_(e),s=p.bind(null,i,e),n=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return s(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;s(t=e)}else n()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=(void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s));var i=r(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var s=0;s<i.length;s++){var n=a(i[s]);h[n].references--}for(var _=r(t,e),o=0;o<i.length;o++){var l=a(i[o]);0===h[l].references&&(h[l].updater(),h.splice(l,1))}i=_}}}}},e={};function i(s){var n=e[s];if(void 0!==n)return n.exports;var h=e[s]={id:s,exports:{}};return t[s](h,h.exports,i),h.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t=i(379),e=i.n(t),s=i(235);e()(s.Z,{insert:"head",singleton:!1}),s.Z.locals;const n="http://www.w3.org/2000/svg";class h{constructor(t,e,i){this._parent=t,this._name=e,this._id=i,this._minStep=2*Math.PI/8,this._c={},this._wVer=-1,this._gS=0,this._gE=0,this._beta=0,this._tilt=0,this._lambda=0,this._sys=0,this._visible=!0,this._useMouseFunctions=!1,this._thick=1,this._rgba="#ff0000ff",this._needs_updateStyle=!0,this._back=document.createElementNS(n,"path"),this._back.setAttribute("fill","none"),this._parent._bC.appendChild(this._back),this._front=document.createElementNS(n,"path"),this._front.setAttribute("fill","none"),this._parent._fC.appendChild(this._front)}update(){if(this._needs_updateStyle&&(this._back.setAttribute("stroke-width",this._thick),this._back.setAttribute("stroke",this._rgba),this._front.setAttribute("stroke-width",this._thick),this._front.setAttribute("stroke",this._rgba),this._needs_updateStyle=!1),this._needs_updateIsVisible&&(this._visible?(this._back.setAttribute("display","inline"),this._front.setAttribute("display","inline")):(this._back.setAttribute("display","none"),this._front.setAttribute("display","none")),this._needs_updateIsVisible=!1),this._visible&&this._needs_update){if(0!=this._sys||this._wLastVer==this._wVer&&this._aLastVer==this._parent._aVer)if(1!=this._sys||this._wLastVer==this._wVer&&this._bLastVer==this._parent._bVer){var t=this._c;e=t.v0,i=t.v1,s=t.v2,n=t.v3,h=t.v4,a=t.v5,r=t.v6,_=t.v7,o=t.v8}else{l=this._c,d=this._parent._c;var e=l.v0=d.b0*l.w0+d.b1*l.w3,i=l.v1=d.b0*l.w1+d.b1*l.w4+d.b2*l.w7,s=l.v2=d.b0*l.w2+d.b1*l.w5+d.b2*l.w8,n=l.v3=d.b3*l.w0+d.b4*l.w3,h=l.v4=d.b3*l.w1+d.b4*l.w4+d.b5*l.w7,a=l.v5=d.b3*l.w2+d.b4*l.w5+d.b5*l.w8,r=l.v6=d.b6*l.w0+d.b7*l.w3,_=l.v7=d.b6*l.w1+d.b7*l.w4+d.b8*l.w7,o=l.v8=d.b6*l.w2+d.b7*l.w5+d.b8*l.w8;this._wLastVer=this._wVer,this._bLastVer=this._parent._bVer}else{var l=this._c,d=this._parent._c;e=l.v0=d.a0*l.w0+d.a1*l.w3,i=l.v1=d.a0*l.w1+d.a1*l.w4,s=l.v2=d.a0*l.w2+d.a1*l.w5,n=l.v3=d.a3*l.w0+d.a4*l.w3,h=l.v4=d.a3*l.w1+d.a4*l.w4+d.a5*l.w7,a=l.v5=d.a3*l.w2+d.a4*l.w5+d.a5*l.w8,r=l.v6=d.a6*l.w0+d.a7*l.w3,_=l.v7=d.a6*l.w1+d.a7*l.w4+d.a8*l.w7,o=l.v8=d.a6*l.w2+d.a7*l.w5+d.a8*l.w8;this._wLastVer=this._wVer,this._aLastVer=this._parent._aVer}var p=this._minStep;this._back.setAttribute("d",""),this._front.setAttribute("d","");var u=Math.sqrt(r*r+_*_);if(0==u)P(this._gS,this._gE,o<0?this._back:this._front);else{var c=-o/u;if(c<=-1)P(this._gS,this._gE,this._front);else if(c>=1)P(this._gS,this._gE,this._back);else{var b=Math.asin(c),m=Math.atan2(r,_);if(Math.cos(b)<0)var y=((b-m)%(2*Math.PI)+2*Math.PI)%(2*Math.PI),x=((Math.PI-b-m)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);else y=((Math.PI-b-m)%(2*Math.PI)+2*Math.PI)%(2*Math.PI),x=((b-m)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(this._gS==this._gE)P(x,y,this._front),P(y,x,this._back);else{var g=[[x,0],[y,1],[this._gS,2],[this._gE,3]];g.sort(this.gSort);for(var z,f=!1,v=!0,S=0;S<4;S++)0==g[S][1]?v=!0:1==g[S][1]?v=!1:f=2==g[S][1];for(var M=g[3],w=0;w<4;w++)z=M,M=g[w],f&&z[0]!=M[0]&&P(z[0],M[0],v?this._front:this._back),0==M[1]?v=!0:1==M[1]?v=!1:f=2==M[1]}}}}function P(t,r,_){r<t&&(r+=2*Math.PI);var o=r-t;0==o&&(o=2*Math.PI);var l=Math.ceil(o/p),d=o/l,u=d/2,c=Math.cos,b=Math.sin,m=1/c(u),y=c(t),x=b(t);let g="M "+(e*y+i*x+s)+" "+(n*y+h*x+a)+" Q";for(var z=t+d,f=z-u,v=0;v<l;v++){y=c(z),x=b(z);var S=m*c(f),M=m*b(f);g+=" "+(e*S+i*M+s)+" "+(n*S+h*M+a)+" "+(e*y+i*x+s)+" "+(n*y+h*x+a),z+=d,f+=d}_.setAttribute("d",g)}}gSort(t,e){return t[0]<e[0]?-1:t[0]>e[0]?1:0}setStyle(t,e){null!=t&&(this._thick=t),null!=e&&(this._rgba=e),this._needs_updateStyle=!0}setArcPoints(t,e){if(null!=t.az&&null!=t.alt){this._sys=0;var i=(360-t.az)*(Math.PI/180),s=t.alt*(Math.PI/180)}else{if(null==t.ra||null==t.dec)return!1;this._sys=1,i=t.ra*(Math.PI/12),s=t.dec*(Math.PI/180)}if("string"==typeof e)return this._parent[e],!1;if(null!=e.az&&null!=e.alt){if(0==this._sys)var n=(360-e.az)*(Math.PI/180),h=e.alt*(Math.PI/180);else if(1==this._sys){var a=new Object;this._parent.MHtoC({az:(360-e.az)*(Math.PI/180),alt:e.alt*(Math.PI/180)},a),n=a.ra,h=a.dec}}else{if(null==e.ra||null==e.dec)return!1;if(0==this._sys){var r=new Object;this._parent.CtoMH({ra:e.ra*(Math.PI/12),dec:e.dec*(Math.PI/180)},r),n=r.az,h=r.alt}else 1==this._sys&&(n=e.ra*(Math.PI/12),h=e.dec*(Math.PI/180))}var _,o,l=Math.cos(s),d=_=Math.sin(s),p=l*Math.cos(i),u=l*Math.sin(i),c=Math.cos(h),b=o=Math.sin(h),m=c*Math.cos(n),y=c*Math.sin(n),x=u*o-y*_,g=m*_-p*o,z=p*y-m*u,f=Math.sqrt(x*x+g*g+z*z);if(f<1e-6)return(p!=m||u!=y||_!=o)&&(this._lambda=0,this._tilt=Math.PI/2,this._beta=Math.atan2(u,p),this._gS=Math.acos(Math.sqrt(p*p+u*u)),_<0&&(this._gS=-this._gS),this._gS=this.mod(this._gS,2*Math.PI),this._gE=(this._gS+Math.PI)%(2*Math.PI),this.doW(),!0);if(this._lambda=0,this._tilt=Math.acos(z/f),0==this._tilt)this._beta=0,this._gS=this.mod(Math.atan2(u,p),2*Math.PI),this._gE=this.mod(Math.atan2(y,m),2*Math.PI);else if(this._tilt==Math.PI)this._beta=0,this._gS=this.mod(Math.atan2(-u,p),2*Math.PI),this._gE=this.mod(Math.atan2(-y,m),2*Math.PI);else{this._beta=Math.atan2(x,-g);var v=Math.sin(this._tilt);this._gS=this.mod(Math.atan2(d/v,l*Math.cos(i-this._beta)),2*Math.PI),this._gE=this.mod(Math.atan2(b/v,c*Math.cos(n-this._beta)),2*Math.PI)}return this.doW(),!0}setParameters(t){null!=t.az&&null!=t.alt&&null!=t.tilt?(this._sys=0,isFinite(t.tilt)&&(t.tilt<0?this._tilt=0:t.tilt>180?this._tilt=Math.PI:this._tilt=t.tilt*(Math.PI/180)),isFinite(t.alt)&&(t.alt<-90?this._lambda=-Math.PI:t.alt>90?this._lambda=Math.PI:this._lambda=t.alt*(Math.PI/180)),isFinite(t.az)&&(this._beta=Math.PI/180*this.mod(-t.az,360)),isFinite(t.gammaStart)&&(this._gS=Math.PI/180*this.mod(t.gammaStart,360)),isFinite(t.gammaEnd)&&(this._gE=Math.PI/180*this.mod(t.gammaEnd,360))):null!=t.ra&&null!=t.dec&&null!=t.tilt&&(this._sys=1,isFinite(t.tilt)&&(t.tilt<0?this._tilt=0:t.tilt>180?this._tilt=Math.PI:this._tilt=t.tilt*(Math.PI/180)),isFinite(t.dec)&&(t.dec<-90?this._lambda=-Math.PI:t.dec>90?this._lambda=Math.PI:this._lambda=t.dec*(Math.PI/180)),isFinite(t.ra)&&(this._beta=Math.PI/12*this.mod(t.ra,24)),isFinite(t.gammaStart)&&(this._gS=Math.PI/180*this.mod(t.gammaStart,360)),isFinite(t.gammaEnd)&&(this._gE=Math.PI/180*this.mod(t.gammaEnd,360))),this.doW(),this._needs_update=!0}doW(){var t=Math.sin(this._tilt),e=Math.cos(this._tilt),i=Math.sin(this._beta),s=Math.cos(this._beta),n=Math.cos(this._lambda),h=Math.sin(this._lambda),a=this._c;a.w0=n*s,a.w1=-n*i*e,a.w2=h*i*t,a.w3=n*i,a.w4=n*s*e,a.w5=-h*s*t,a.w7=n*t,a.w8=h*e,this._wVer++}mod(t,e){return(t%e+e)%e}getGammaStart(){return 180/Math.PI*this._gS}setGammaStart(t){isFinite(t)&&(this._gS=Math.PI/180*this.mod(t,360),this._needs_update=!0)}getGammaEnd(){return 180/Math.PI*this._gE}setGammaEnd(t){isFinite(t)&&(this._gE=Math.PI/180*this.mod(t,360),this._needs_update=!0)}getTilt(){return this._tilt*(180/Math.PI)}setTilt(t){isFinite(t)&&(this._tilt=t<0?0:t>180?Math.PI:t*(Math.PI/180),this.doW(),this._needs_update=!0)}getLambda(){return this._lambda*(180/Math.PI)}setLambda(t){if(isFinite(t))return this._lambda=t<-90?-Math.PI:t>90?Math.PI:t*(Math.PI/180),this.doW(),this._needs_update=!0,!0}setAlt(t){this.setLambda(t)&&(this._sys=0)}setDec(t){this.setLambda(t)&&(this._sys=1)}getBeta(){return this._beta*(180/Math.PI)}setBeta(t){if(isFinite(t))return this._beta=Math.PI/180*this.mod(t,360),this.doW(),this._needs_update=!0,!0}getAz(){return this.mod(-this.getBeta(),360)}setAz(t){this.setBeta(-t)&&(this._sys=0)}getRa(){return this.getBeta()/15}setRa(t){this.setBeta(15*t)&&(this._sys=1)}getVisible(){return this._visible}setVisible(t){this._needs_updateIsVisible=!0,this._visible=Boolean(t),this.update()}}const a="http://www.w3.org/2000/svg";class r{constructor(t,e,i,s,n,h){this._parent=t,this._name=e,this._id=i,this.setStyle(1,"0x0000FFff"),"object"==typeof s&&this.setStyle(s.thickness,s.color),this._visible=!0,this._head={},this._tail={},this.setPoints(n,h),this._bE=document.createElementNS(a,"path"),this._parent._bEL.appendChild(this._bE),this._fE=document.createElementNS(a,"path"),this._parent._fEL.appendChild(this._fE),this._aI=document.createElementNS(a,"path"),this._parent._iLA.appendChild(this._aI),this._bI=document.createElementNS(a,"path"),this._parent._iLB.appendChild(this._bI)}update(){if(this._needs_updateStyle&&(this._bE.setAttribute("stroke-width",this._thick),this._bE.setAttribute("stroke",this._color),this._fE.setAttribute("stroke-width",this._thick),this._fE.setAttribute("stroke",this._color),this._aI.setAttribute("stroke-width",this._thick),this._aI.setAttribute("stroke",this._color),this._bI.setAttribute("stroke-width",this._thick),this._bI.setAttribute("stroke",this._color),this._needs_updateStyle=!1),!this._visible)return;if(!this._needs_update)return;var t=this._bE,e=this._fE,i=this._aI,s=this._bI,n={},h={};if(0==this._head.sys)this._parent.WtoSz(this._head,n);else{if(1!=this._head.sys)return;this._parent.CtoSz(this._head,n)}if(0==this._tail.sys)this._parent.WtoSz(this._tail,h);else{if(1!=this._tail.sys)return;this._parent.CtoSz(this._tail,h)}var a=n.x-h.x,r=n.y-h.y,_=n.z-h.z,o=a*a+r*r+_*_,l=2*(a*h.x+r*h.y+_*h.z),d=h.x*h.x+h.y*h.y+h.z*h.z,p=this._parent._c.r,u=p*p,c=this._parent._phi,b=[],m=l*l-4*o*(d-u);if(m>0){var y=Math.sqrt(m);b.push((-l+y)/(2*o)),b.push((-l-y)/(2*o))}if(c>-Math.PI/2&&c<Math.PI/2){var x=Math.tan(c);if(r!=x*_&&b.push((x*h.z-h.y)/(r-x*_)),0!=_){var g=-h.z/_;g*(g*o+l)+d>=u&&b.push(g)}}else 0!=_&&b.push(-h.z/_);for(var z=[0,1],f=0;f<b.length;f++)if(b[f]>0&&b[f]<1){for(var v=1;b[f]>z[v];)v++;b[f]!=z[v]&&z.splice(v,0,b[f])}let S="",M="",w="",P="";if(this._parent._showUnder)for(f=0;f<z.length-1;f++){var I=z[f],A=z[f+1],C=" M "+(I*a+h.x)+" "+(I*r+h.y)+" L "+(A*a+h.x)+" "+(A*r+h.y);(L=I+(A-I)/2)*(L*o+l)+d<u?c==-Math.PI/2?L*_+h.z>0?M+=C:S+=C:c==Math.PI/2?L*_+h.z>0?S+=C:M+=C:L*r+h.y-(L*_+h.z)*x>1e-9?M+=C:S+=C:L*_+h.z<0?P+=C:w+=C}else for(f=0;f<z.length-1;f++){var E,L;if((L=(I=z[f])+((A=z[f+1])-I)/2)*(L*o+l)+d<u)if(c==-Math.PI/2){if(L*_+h.z>0)continue;E=i}else if(c==Math.PI/2){if(!(L*_+h.z>0))continue;E=i}else{if(L*r+h.y-(L*_+h.z)*x>1e-9)continue;E=i}else if(c==-Math.PI/2){if(L*_+h.z>0)continue;E=t}else if(c==Math.PI/2){if(!(L*_+h.z>0))continue;E=e}else{if(L*r+h.y-(L*_+h.z)*x>1e-9)continue;E=L*_+h.z<0?t:e}E.setAttribute("d","M "+(I*a+h.x)+" "+(I*r+h.y)+" L "+(A*a+h.x)+" "+(A*r+h.y))}t.setAttribute("d",P),e.setAttribute("d",w),i.setAttribute("d",S),s.setAttribute("d",M)}setStyle(t,e){null!=t&&(this._thick=t),null!=e&&(this._color=e),this._needs_updateStyle=!0}setPoints(t,e){this.setHeadPoint(t),this.setTailPoint(e)}setTailPoint(t){this._parent.parsePointInput(t,this._tail),-1==this._tail.sys&&(this._tail.sys=0),this._needs_update=!0}setHeadPoint(t){this._parent.parsePointInput(t,this._head),-1==this._head.sys&&(this._head.sys=0),this._needs_update=!0}}const _="http://www.w3.org/2000/svg";class o{constructor(t,e,i,s){this._parent=t,this._frontRefId=e,this._backRefId=s,this._controller=null,this._visible=!0,this._p={},this._sp={},this._o={x:0,y:0,z:0},this._n={x:0,y:0,z:1},this._u={x:0,y:0,z:1},this._oType=0;let n={alt:0,az:0,r:1},h={type:"flat"};"object"==typeof i&&(i.hasOwnProperty("position")&&(n=i.position),i.hasOwnProperty("orientation")&&(h=i.orientation),i.hasOwnProperty("controller")&&(this._controller=i.controller)),this._innerElement=null,this._outerElement=document.createElementNS(_,"g"),this._isUsingFront=!0,this.setElement(this._frontRefId,this._backRefId),this.setPosition(n),this.setOrientation(h),this._isVisible=!0,this._needs_updateIsVisible=!1}setElement(t,e){null!==this._innerElement&&this._outerElement.removeElement(this._innerElement),this._frontRefId=t,this._backRefId=null==e?null:e,this._isUsingFront=!0,this._innerElement=document.createElementNS(_,"use"),this._innerElement.setAttribute("href","#"+this._frontRefId),this._outerElement.appendChild(this._innerElement),this._needs_update=!0}setPosition(t){this._needs_update=!0;var e={};this._parent.parsePointInput(t,e),0==e.sys||-1==e.sys?(this._sys=0,this._p=e,this._r=e.r):1==e.sys&&(this._sys=1,this._p=e,this._r=e.r),this._p_o={x:this._p.x+this._o.x,y:this._p.y+this._o.y,z:this._p.z+this._o.z},this._p_n={x:this._p.x+this._n.x,y:this._p.y+this._n.y,z:this._p.z+this._n.z},this._p_u={x:this._p.x+this._u.x,y:this._p.y+this._u.y,z:this._p.z+this._u.z}}getPosition(t){t.x=this._p.x,t.y=this._p.y,t.z=this._p.z,0==this._sys?t.system="horizon":1==this._sys&&(t.system="celestial")}setOrientation(t){let e=t.type,i=t.normal,s=t.up;if(this._needs_update=!0,"flat"==e)this._oType=0;else if("skewed"==e){if(i=s,this._oType=1,"object"!=typeof i){var n=Math.sqrt(this._p.x*this._p.x+this._p.y*this._p.y+this._p.z*this._p.z);this._o={x:this._p.x/n,y:this._p.y/n,z:this._p.z/n}}else{var h=new Object;if(this._parent.parsePointInput(i,h),0==h.sys&&1==this._sys){var a=new Object;this._parent.WtoC(h,a),h=a}else if(1==h.sys&&0==this._sys)a=new Object,this._parent.CtoW(h,a),h=a;else if(null==h.sys)return;n=Math.sqrt(h.x*h.x+h.y*h.y+h.z*h.z),this._o={x:h.x/n,y:h.y/n,z:h.z/n}}this._p_o={x:this._p.x+this._o.x,y:this._p.y+this._o.y,z:this._p.z+this._o.z}}else if("absolute"==e){if(this._oType=2,"object"!=typeof i||"object"!=typeof s){var r=Math.sqrt(this._p.x*this._p.x+this._p.y*this._p.y+this._p.z*this._p.z);if(this._n={x:this._p.x/r,y:this._p.y/r,z:this._p.z/r},0!=this._n.x||0!=this._n.y){this._u={x:-this._n.x*this._n.z,y:-this._n.z*this._n.y,z:this._n.x*this._n.x+this._n.y*this._n.y};var _=Math.sqrt(this._u.x*this._u.x+this._u.y*this._u.y+this._u.z*this._u.z);this._u={x:this._u.x/_,y:this._u.y/_,z:this._u.z/_}}else this._u={x:0,y:1,z:0}}else{var o=new Object;if(this._parent.parsePointInput(i,o),0==o.sys&&1==this._sys)a=new Object,this._parent.WtoC(o,a),o=a;else if(1==o.sys&&0==this._sys)a=new Object,this._parent.CtoW(o,a),o=a;else if(null==o.sys)return;var l=new Object;if(this._parent.parsePointInput(s,l),0==l.sys&&1==this._sys)a=new Object,this._parent.WtoC(l,a),l=a;else if(1==l.sys&&0==this._sys)a=new Object,this._parent.CtoW(l,a),l=a;else if(null==l.sys)return;r=Math.sqrt(o.x*o.x+o.y*o.y+o.z*o.z),this._n={x:o.x/r,y:o.y/r,z:o.z/r};var d=this._n.x,p=this._n.y,u=this._n.z,c=l.x,b=l.y,m=l.z,y=p*p*c-d*p*b-d*u*m+u*u*c,x=u*u*b-p*u*m-d*p*c+d*d*b,g=d*d*m-d*u*c-p*u*b+p*p*m,z=Math.sqrt(y*y+x*x+g*g);this._u={x:y/z,y:x/z,z:g/z}}this._p_u={x:this._p.x+this._u.x,y:this._p.y+this._u.y,z:this._p.z+this._u.z},this._p_n={x:this._p.x+this._n.x,y:this._p.y+this._n.y,z:this._p.z+this._n.z}}}update(){if(this._needs_updateIsVisible&&(this._isVisible?this._innerElement.removeAttribute("display"):this._innerElement.setAttribute("display","none"),this._needs_updateIsVisible=!1),!this._isVisible)return;var t=this._sp;let e,i,s,n,h="translate("+t.x+" "+t.y+")";switch(this._oType){case 0:this._innerElement.setAttribute("transform","rotate(0)"),h+=" rotate(0) scale(1 1)";break;case 1:var a={},r=this._parent._c;if(0==this._sys){var _=this._o.x*r.a6+this._o.y*r.a7+this._o.z*r.a8;this._parent.WtoSz(this._p_o,a)}else 1==this._sys&&(_=this._o.x*r.b6+this._o.y*r.b7+this._o.z*r.b8,this._parent.CtoSz(this._p_o,a));s=1,n=Math.sqrt(1-_*_/r.r2),i=180/Math.PI*Math.atan2(a.y-t.y,a.x-t.x)+90,(isNaN(i)||isNaN(n))&&(console.log("case 1"),console.log(a),console.log(t),console.log(_)),h+=" rotate("+i+")",h+=" scale("+s+" "+n+")",e=0,this._innerElement.setAttribute("transform","rotate("+e+")");break;case 2:r=this._parent._c;var o={},l={};if(0==this._sys){var d=(this._n.x*r.a6+this._n.y*r.a7+this._n.z*r.a8)/r.r;this._parent.WtoSz(this._p_n,l),this._parent.WtoSz(this._p_u,o)}else 1==this._sys&&(d=(this._n.x*r.b6+this._n.y*r.b7+this._n.z*r.b8)/r.r,this._parent.CtoSz(this._p_n,l),this._parent.CtoSz(this._p_u,o));null!==this._backRefId&&(l.z<0&&this._isUsingFront?(this._innerElement.setAttribute("href","#"+this._backRefId),this._isUsingFront=!1):l.z>0&&!this._isUsingFront&&(this._innerElement.setAttribute("href","#"+this._frontRefId),this._isUsingFront=!0));var p=Math.atan2(l.y-t.y,l.x-t.x)+Math.PI/2;i=180/Math.PI*p,s=1,n=d,h+=" rotate("+i+")",h+=" scale("+s+" "+n+")",(isNaN(i)||isNaN(n))&&(console.log("case 2"),console.log(l),console.log(t),console.log(d));var u=Math.cos(p),c=Math.sin(p),b=o.x-t.x,m=o.y-t.y,y=u*b+c*m,x=(-c*b+u*m)/d;e=180/Math.PI*Math.atan2(x,y)+90,Number.isNaN(e)&&(e=0),this._innerElement.setAttribute("transform","rotate("+e+")")}this._outerElement.setAttribute("transform",h),null!==this._controller&&this._controller.update(this),this._needs_update=!1}setIsVisible(t){this._isVisible!==t&&(this._isVisible=t,this._needs_updateIsVisible=!0,this.update())}getPositionHorizon(){let t={};return this._parent.pointToHorizon(this._p,t),t}getPositionCelestial(){let t={};return this._parent.pointToCelestial(this._p,t),t}}const l="http://www.w3.org/2000/svg";class d{constructor(t){this._parent=t,this._element=document.createElementNS(l,"g"),this._defs=document.createElementNS(l,"defs"),this._element.appendChild(this._defs),this._landGradientId=this._parent._htmlId+"-g-land",this._waterGradientId=this._parent._htmlId+"-g-water",this._landGradient=document.createElementNS(l,"radialGradient"),this._landGradient.setAttribute("id",this._landGradientId),this._landGradient.setAttribute("cx","65%"),this._landGradient.setAttribute("cy","35%"),this._landGradient.setAttribute("r","70%");const e=document.createElementNS(l,"stop");e.setAttribute("offset","0%"),e.setAttribute("stop-color","#c8a977"),this._landGradient.appendChild(e);const i=document.createElementNS(l,"stop");i.setAttribute("offset","100%"),i.setAttribute("stop-color","#98753d"),this._landGradient.appendChild(i),this._defs.appendChild(this._landGradient),this._waterGradient=document.createElementNS(l,"radialGradient"),this._waterGradient.setAttribute("id",this._waterGradientId),this._waterGradient.setAttribute("cx","65%"),this._waterGradient.setAttribute("cy","35%"),this._waterGradient.setAttribute("r","70%");const s=document.createElementNS(l,"stop");s.setAttribute("offset","0%"),s.setAttribute("stop-color","#e2eafc"),this._waterGradient.appendChild(s);const n=document.createElementNS(l,"stop");n.setAttribute("offset","100%"),n.setAttribute("stop-color","#8493f0"),this._waterGradient.appendChild(n),this._defs.appendChild(this._waterGradient),this._maskId=this._parent._htmlId+"-g-mask",this._mask=document.createElementNS(l,"mask"),this._mask.setAttribute("id",this._maskId),this._defs.appendChild(this._mask),this._maskPath=document.createElementNS(l,"path"),this._maskPath.setAttribute("stroke","none"),this._maskPath.setAttribute("fill","white"),this._mask.appendChild(this._maskPath),this._c={},this._r=1,this._rotationAngle=0,this.setPrecession(0),this._water=document.createElementNS(l,"circle"),this._water.setAttribute("r",50),this._water.setAttribute("fill","url(#"+this._waterGradientId+")"),this._element.appendChild(this._water),this._land=document.createElementNS(l,"circle"),this._land.setAttribute("r",50),this._land.setAttribute("fill","url(#"+this._landGradientId+")"),this._land.setAttribute("mask","url(#"+this._maskId+")"),this._element.appendChild(this._land)}getElement(){return this._element}update(){this._updateGlobe()}setPrecession(t){this._precession=(t%360+360)%360*(Math.PI/180);var e=Math.cos(this._precession),i=Math.sin(this._precession),s=this._c;s.p0=e,s.p1=-i,s.p3=.91706*i,s.p4=.91706*e,s.p5=-.39875,s.p6=.39875*i,s.p7=.39875*e,s.p8=.91706}setRotation(t){this._rotationAngle=(t%360+360)%360*(Math.PI/180)}calculateRConstants(){var t=this._parent._sTime+this._rotationAngle,e=Math.cos(t),i=Math.sin(t),s=this._c;s.r0=e,s.r1=-i,s.r3=.91706*i,s.r4=.91706*e,s.r5=.39875,s.r6=.39875*-i,s.r7=.39875*-e,s.r8=.91706}calculateQConstants(){var t=this._c;t.q0=t.p0*t.r0+t.p1*t.r3,t.q1=t.p0*t.r1+t.p1*t.r4,t.q2=t.p1*t.r5,t.q3=t.p3*t.r0+t.p4*t.r3+t.p5*t.r6,t.q4=t.p3*t.r1+t.p4*t.r4+t.p5*t.r7,t.q5=t.p4*t.r5+t.p5*t.r8,t.q6=t.p6*t.r0+t.p7*t.r3+t.p8*t.r6,t.q7=t.p6*t.r1+t.p7*t.r4+t.p8*t.r7,t.q8=t.p7*t.r5+t.p8*t.r8}_updateGlobe(){this.calculateRConstants(),this.calculateQConstants();var t=this._c;let e=this._parent._c,i=e.r,s=this._r;this._water.setAttribute("r",i),this._land.setAttribute("r",i);var n=s*(e.b0*t.q0+e.b1*t.q3+e.b2*t.q6),h=s*(e.b0*t.q1+e.b1*t.q4+e.b2*t.q7),a=s*(e.b0*t.q2+e.b1*t.q5+e.b2*t.q8),r=s*(e.b3*t.q0+e.b4*t.q3+e.b5*t.q6),_=s*(e.b3*t.q1+e.b4*t.q4+e.b5*t.q7),o=s*(e.b3*t.q2+e.b4*t.q5+e.b5*t.q8),l=s*(e.b6*t.q0+e.b7*t.q3+e.b8*t.q6),d=s*(e.b6*t.q1+e.b7*t.q4+e.b8*t.q7),u=s*(e.b6*t.q2+e.b7*t.q5+e.b8*t.q8),c=Math.cos,b=Math.sin,m=Math.atan2,y=Math.ceil,x=p,g=1.5*i,z=2*Math.acos(1.1*i/g);let f="";for(var v=0;v<x.length;v++){for(var S=x[v],M=S.length,w=!1,P=0;P<M;P++)if((C=S[P]).x*l+C.y*d+C.z*u>0){if(w){f+="M "+(C.x*n+C.y*h+C.z*a)+" "+(C.x*r+C.y*_+C.z*o)+" ";break}w=!0}else w=!1;if(P!=M)for(var I=!1,A=1;A<M;A++){var C,E=(C=S[(P+A)%M]).x*l+C.y*d+C.z*u<0;if(E){if(!I){var L=C.x*n+C.y*h+C.z*a,k=m(C.x*r+C.y*_+C.z*o,L);f+=" L "+g*c(k)+" "+g*b(k)+" "}}else if(I){var N,O=C.x*n+C.y*h+C.z*a,q=C.x*r+C.y*_+C.z*o,D=((m(q,O)-k)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(D>Math.PI)var F=-(D=2*Math.PI-D)/(N=y(D/z));else F=D/(N=y(D/z));for(var G=1;G<=N;G++){var B=k+F*G;f+=" L "+g*c(B)+" "+g*b(B)+" "}f+=" L "+O+" "+q+" "}else f+=" L "+(C.x*n+C.y*h+C.z*a)+" "+(C.x*r+C.y*_+C.z*o)+" ";I=E}}this._maskPath.setAttribute("d",f)}}const p=[[{x:-.3346,y:.0459,z:.9413},{x:-.3416,y:.0996,z:.9346},{x:-.2114,y:.2266,z:.9508},{x:-.096,y:.2606,z:.9607},{x:-.0754,y:.2221,z:.9721},{x:.1858,y:.3188,z:.9294},{x:.2601,y:.2689,z:.9274},{x:.3333,y:.1093,z:.9365},{x:.5148,y:.0304,z:.8568},{x:.5205,y:.0699,z:.851},{x:.4949,y:.0935,z:.8639},{x:.5415,y:.1316,z:.8304},{x:.4746,y:.1559,z:.8663},{x:.4533,y:.1428,z:.8798},{x:.3811,y:.182,z:.9064},{x:.5518,y:.1955,z:.8107},{x:.5657,y:.1123,z:.8169},{x:.5325,y:.0913,z:.8415},{x:.5788,y:.0726,z:.8123},{x:.6521,y:5e-4,z:.7582},{x:.6599,y:-.0552,z:.7494},{x:.6902,y:-.0128,z:.7235},{x:.7263,y:-.0199,z:.6871},{x:.7223,y:-.1168,z:.6817},{x:.7875,y:-.1261,z:.6033},{x:.8049,y:-.079,z:.5882},{x:.7916,y:-.0099,z:.611},{x:.7267,y:.0424,z:.6856},{x:.7059,y:.1082,z:.7},{x:.7406,y:.2044,z:.6401},{x:.761,y:.2109,z:.6135},{x:.7249,y:.2418,z:.645},{x:.7003,y:.1548,z:.6969},{x:.6782,y:.1634,z:.7165},{x:.701,y:.2505,z:.6677},{x:.7398,y:.316,z:.5939},{x:.7024,y:.2932,z:.6486},{x:.6614,y:.3481,z:.6644},{x:.5977,y:.3465,z:.723},{x:.5499,y:.4863,z:.679},{x:.6837,y:.3491,z:.6408},{x:.7121,y:.3693,z:.5971},{x:.6462,y:.4721,z:.5996},{x:.7063,y:.479,z:.5213},{x:.7515,y:.4162,z:.5118},{x:.7804,y:.3107,z:.5427},{x:.816,y:.2808,z:.5053},{x:.8186,y:.1474,z:.5552},{x:.7832,y:.1514,z:.6031},{x:.8072,y:-.0792,z:.5849},{x:.8913,y:-.2764,z:.3594},{x:.9222,y:-.2913,z:.2545},{x:.968,y:-.2156,z:.1285},{x:.996,y:-.0345,z:.0829},{x:.991,y:.0669,z:.116},{x:.9841,y:.1734,z:.0387},{x:.9529,y:.2358,z:-.191},{x:.9216,y:.199,z:-.3334},{x:.7843,y:.2596,z:-.5635},{x:.7424,y:.3784,z:-.5528},{x:.7432,y:.53,z:-.4084},{x:.7742,y:.5361,z:-.3363},{x:.7322,y:.6312,z:-.2559},{x:.7731,y:.629,z:-.0816},{x:.6711,y:.7371,z:.0794},{x:.6185,y:.7582,z:.2064},{x:.7094,y:.6835,z:.172},{x:.7425,y:.6167,z:.2616},{x:.7323,y:.4634,z:.499},{x:.7047,y:.6485,z:.288},{x:.709,y:.6702,z:.2195},{x:.547,y:.7839,z:.2936},{x:.4669,y:.7999,z:.3771},{x:.5075,y:.7499,z:.4244},{x:.5708,y:.7106,z:.4113},{x:.5873,y:.6439,z:.4903},{x:.5637,y:.6524,z:.5065},{x:.4562,y:.7854,z:.4183},{x:.285,y:.8918,z:.3513},{x:.2137,y:.9667,z:.1405},{x:.1742,y:.9683,z:.179},{x:.1617,y:.9492,z:.2701},{x:-.0245,y:.9218,z:.3868},{x:-.0724,y:.9584,z:.276},{x:-.1291,y:.9498,z:.2851},{x:-.1512,y:.9825,z:.1087},{x:-.2453,y:.9692,z:.024},{x:-.2253,y:.9697,z:.0943},{x:-.162,y:.9742,z:.1569},{x:-.1693,y:.9583,z:.2302},{x:-.2604,y:.9534,z:.1521},{x:-.324,y:.9204,z:.2189},{x:-.2558,y:.9105,z:.3249},{x:-.4007,y:.8273,z:.3937},{x:-.461,y:.7336,z:.4994},{x:-.4007,y:.7145,z:.5736},{x:-.428,y:.6691,z:.6076},{x:-.385,y:.6794,z:.6247},{x:-.4476,y:.6263,z:.6383},{x:-.4855,y:.663,z:.5698},{x:-.5161,y:.6355,z:.5743},{x:-.4692,y:.6094,z:.6391},{x:-.5192,y:.5174,z:.6803},{x:-.5026,y:.4055,z:.7635},{x:-.4193,y:.3708,z:.8287},{x:-.4622,y:.1663,z:.871},{x:-.5025,y:.2226,z:.8355},{x:-.5765,y:.2476,z:.7787},{x:-.5338,y:.1583,z:.8306},{x:-.4863,y:.1283,z:.8643},{x:-.4672,y:.0074,z:.8841},{x:-.418,y:.0021,z:.9084},{x:-.4004,y:-.072,z:.9135}],[{x:.206,y:-.5678,z:-.797},{x:.3392,y:-.6758,z:-.6544},{x:.5784,y:-.6598,z:-.4797},{x:.5974,y:-.6792,z:-.4264},{x:.6996,y:-.6096,z:-.3727},{x:.7597,y:-.612,z:-.22},{x:.8105,y:-.5663,z:-.1498},{x:.8141,y:-.5728,z:-.0954},{x:.6662,y:-.7455,z:.0175},{x:.6302,y:-.767,z:.1205},{x:.3556,y:-.9081,z:.2212},{x:.2267,y:-.9645,z:.1355},{x:.1876,y:-.9681,z:.1662},{x:.1322,y:-.9786,z:.1575},{x:.1114,y:-.9592,z:.2597},{x:.0201,y:-.9619,z:.2728},{x:.0499,y:-.9301,z:.3639},{x:-.0045,y:-.9324,z:.3614},{x:-.0268,y:-.9479,z:.3173},{x:-.1023,y:-.9327,z:.3458},{x:-.125,y:-.8816,z:.4551},{x:-.0824,y:-.8601,z:.5034},{x:.0953,y:-.8597,z:.5018},{x:.1497,y:-.8938,z:.4228},{x:.1263,y:-.8453,z:.5192},{x:.1937,y:-.7964,z:.5729},{x:.2105,y:-.7227,z:.6583},{x:.2559,y:-.7013,z:.6653},{x:.2381,y:-.6877,z:.6859},{x:.2978,y:-.6315,z:.7159},{x:.3001,y:-.6601,z:.6886},{x:.3373,y:-.6187,z:.7096},{x:.2658,y:-.6144,z:.7428},{x:.2193,y:-.6474,z:.7299},{x:.2561,y:-.5848,z:.7697},{x:.3205,y:-.5532,z:.7689},{x:.3322,y:-.4862,z:.8082},{x:.284,y:-.4991,z:.8187},{x:.2136,y:-.4479,z:.8682},{x:.195,y:-.4938,z:.8474},{x:.1718,y:-.4534,z:.8746},{x:.0976,y:-.4563,z:.8845},{x:.1089,y:-.6066,z:.7875},{x:.0729,y:-.5727,z:.8165},{x:-.0263,y:-.5471,z:.8366},{x:-.0364,y:-.4856,z:.8734},{x:.0594,y:-.3827,z:.922},{x:.052,y:-.3518,z:.9346},{x:.0091,y:-.376,z:.9266},{x:-.0262,y:-.3095,z:.9505},{x:-.0904,y:-.365,z:.9266},{x:-.2194,y:-.2788,z:.9349},{x:-.2931,y:-.1264,z:.9477},{x:-.3515,y:-.0852,z:.9323},{x:-.3753,y:-.1338,z:.9172},{x:-.407,y:-.0856,z:.9094},{x:-.406,y:-.1419,z:.9028},{x:-.4614,y:-.1161,z:.8795},{x:-.4954,y:-.1572,z:.8543},{x:-.4735,y:-.2013,z:.8575},{x:-.5529,y:-.168,z:.8162},{x:-.4737,y:-.2264,z:.8511},{x:-.4053,y:-.2586,z:.8768},{x:-.3598,y:-.3663,z:.8581},{x:-.3688,y:-.5542,z:.7462},{x:-.433,y:-.6465,z:.6282},{x:-.3806,y:-.7794,z:.4977},{x:-.3212,y:-.8604,z:.3956},{x:-.3576,y:-.7715,z:.5262},{x:-.2197,y:-.924,z:.313},{x:.0463,y:-.9711,z:.2343},{x:.1108,y:-.9829,z:.1468},{x:.1636,y:-.9786,z:.125},{x:.1918,y:-.9704,z:.147},{x:.2199,y:-.9734,z:.0637},{x:.1579,y:-.9849,z:-.0705},{x:.2319,y:-.939,z:-.254},{x:.3228,y:-.8834,z:-.3398},{x:.2626,y:-.7902,z:-.5538},{x:.2245,y:-.7628,z:-.6064},{x:.1743,y:-.5802,z:-.7956}],[{x:.2884,y:-.169,z:.9425},{x:.258,y:-.135,z:.9567},{x:.2665,y:-.0991,z:.9587},{x:.1582,y:-.0467,z:.9863},{x:.0767,y:-.1085,z:.9911},{x:.0709,y:-.1896,z:.9793},{x:.2796,y:-.3484,z:.8947},{x:.3541,y:-.3522,z:.8663}],[{x:-.6199,y:.4769,z:-.6232},{x:-.7027,y:.3948,z:-.5919},{x:-.8027,y:.4056,z:-.4373},{x:-.7799,y:.5977,z:-.1855},{x:-.7366,y:.6049,z:-.3026},{x:-.6881,y:.6783,z:-.2577},{x:-.7106,y:.6728,z:-.2059},{x:-.6562,y:.7295,z:-.193},{x:-.6152,y:.7435,z:-.2623},{x:-.5707,y:.7852,z:-.2406},{x:-.487,y:.8068,z:-.3345},{x:-.3773,y:.8479,z:-.3725},{x:-.3439,y:.7982,z:-.4946},{x:-.4027,y:.7092,z:-.5787},{x:-.5375,y:.6569,z:-.5288},{x:-.616,y:.5528,z:-.5612}],[{x:.195,y:-.4301,z:.8815},{x:.1489,y:-.3678,z:.9179},{x:.1884,y:-.3839,z:.9039},{x:.1903,y:-.3474,z:.9182},{x:.0234,y:-.286,z:.9579},{x:.0282,y:-.3259,z:.945},{x:.1146,y:-.3675,z:.9229},{x:.1043,y:-.411,z:.9056}],[{x:.3616,y:8e-4,z:-.9323},{x:.2757,y:-.095,z:-.9565},{x:.1623,y:-.1217,z:-.9792},{x:.1207,y:-.2253,z:-.9668},{x:.2426,y:-.377,z:-.8939},{x:.0849,y:-.3383,z:-.9372},{x:.0888,y:-.2744,z:-.9575},{x:-.0569,y:-.3062,z:-.9503},{x:-.1779,y:-.2219,z:-.9587},{x:-.2086,y:.0366,z:-.9773},{x:-.3158,y:.0556,z:-.9472},{x:-.2925,y:.2905,z:-.9111},{x:-.0938,y:.4102,z:-.9072},{x:.056,y:.4063,z:-.912},{x:.0955,y:.3336,z:-.9379},{x:.2419,y:.3294,z:-.9127},{x:.3116,y:.1986,z:-.9292},{x:.3043,y:.1373,z:-.9426}],[{x:-.8538,y:.5009,z:-.1421},{x:-.7416,y:.6703,z:-.0256},{x:-.709,y:.7032,z:-.0528},{x:-.6683,y:.7438,z:-.0045},{x:-.6686,y:.741,z:-.0628},{x:-.74,y:.6658,z:-.0956},{x:-.7476,y:.6484,z:-.1438},{x:-.7854,y:.5973,z:-.1622},{x:-.8088,y:.5738,z:-.129}],[{x:.412,y:-.5346,z:.7379},{x:.3479,y:-.5141,z:.784},{x:.3439,y:-.5681,z:.7477},{x:.3846,y:-.5658,z:.7293}],[{x:-.476,y:.8794,z:.0094},{x:-.4487,y:.8918,z:.0578},{x:-.4865,y:.8683,z:.0968},{x:-.4544,y:.8824,z:.1219},{x:-.3257,y:.9452,z:.0238},{x:-.3543,y:.9338,z:-.0508},{x:-.4199,y:.9043,z:-.0771}],[{x:.6229,y:-.0015,z:.7823},{x:.5351,y:-.0161,z:.8447},{x:.5191,y:-.045,z:.8535},{x:.5664,y:-.054,z:.8224},{x:.6044,y:-.0332,z:.796},{x:.6377,y:-.0634,z:.7677}],[{x:-.6002,y:.5602,z:.5709},{x:-.63,y:.5126,z:.5834},{x:-.5865,y:.4671,z:.6617},{x:-.5851,y:.5637,z:.583},{x:-.5406,y:.6248,z:.5634},{x:-.5876,y:.603,z:.5395}],[{x:.617,y:.664,z:-.4225},{x:.6136,y:.7434,z:-.2664},{x:.6383,y:.7414,z:-.2071},{x:.6869,y:.6617,z:-.3006},{x:.6624,y:.6263,z:-.4111}],[{x:-.5157,y:.8519,z:-.0911},{x:-.5141,y:.857,z:-.0346},{x:-.5742,y:.8181,z:.0314},{x:-.5062,y:.8623,z:.0162},{x:-.4805,y:.8757,z:-.0484}],[{x:.4193,y:-.1148,z:.9006},{x:.3867,y:-.0987,z:.9169},{x:.3781,y:-.1507,z:.9134},{x:.4088,y:-.1714,z:.8964}],[{x:.6119,y:-.0864,z:.7862},{x:.5713,y:-.0666,z:.818},{x:.5764,y:-.1031,z:.8107},{x:.605,y:-.1146,z:.7879}],[{x:-.7522,y:.0451,z:-.6574},{x:-.8171,y:.0431,z:-.5749},{x:-.8274,y:.0859,z:-.555},{x:-.7623,y:.0812,z:-.6421}],[{x:-.2696,y:.958,z:-.0974},{x:-.2767,y:.9593,z:-.0563},{x:-.2353,y:.9719,z:.0031},{x:-.0907,y:.9911,z:.0973}],[{x:.2428,y:-.9068,z:.3446},{x:.1414,y:-.9078,z:.3949},{x:.0949,y:-.9173,z:.3867},{x:.1925,y:-.9144,z:.3562},{x:.2009,y:-.9193,z:.3384}],[{x:.0223,y:-.7332,z:.6796},{x:.0589,y:-.6836,z:.7275},{x:-.0229,y:-.6822,z:.7308},{x:.0178,y:-.6568,z:.7539},{x:.1038,y:-.6978,z:.7087},{x:.0942,y:-.7242,z:.6831},{x:.0629,y:-.698,z:.7134},{x:.0448,y:-.7453,z:.6652}],[{x:.4824,y:.5331,z:.6951},{x:.4116,y:.5444,z:.7309},{x:.4499,y:.5682,z:.689},{x:.4702,y:.6478,z:.5994},{x:.521,y:.5986,z:.6085}],[{x:.3431,y:-.8806,z:.3269},{x:.2745,y:-.8987,z:.3421},{x:.2662,y:-.9088,z:.3212},{x:.3042,y:-.8984,z:.3167}],[{x:-.5955,y:.4446,z:.6691},{x:-.6012,y:.4083,z:.6869},{x:-.5515,y:.4322,z:.7135},{x:-.5679,y:.4685,z:.6767},{x:-.5955,y:.4446,z:.6691},{x:-.5955,y:.4446,z:.6691}]];let u=[];function c(t,e){return t<0?t%e+e:t%e}let b=0;const m="http://www.w3.org/2000/svg";class y{static addInstance(t){u.push(t),t._initFinish()}constructor(t){this._htmlId="cs"+b++,this._onDraggingDidUpdate=null,this._c={},this._aVer=-1,this._bVer=-1,this._objectFreeID=0,this._objectList=[],this._objectElements=[],this._circleFreeID=0,this._circleList=[],this._lineFreeID=0,this._lineList=[],this._decTrailFreeID=0,this._decTrailList=[],this._shadedBandFreeID=0,this._shadedBandList=[],this._maxPhi=90,this._minPhi=-90,this._phi=Math.PI/180*20,this._theta=Math.PI/180*90,this._c.r=150,this._c.r2=this._c.r*this._c.r,this._showUnder=!0,this._width=400,this._height=400,this._x=0,this._y=0,this._element=document.createElement("div"),this._element.classList.add("cs"),this._element.style.position="absolute",this._svg=document.createElementNS(m,"svg"),this._svgGroup=document.createElementNS(m,"g"),this._svg.appendChild(this._svgGroup),this._defs=document.createElementNS(m,"defs"),this._svgGroup.appendChild(this._defs),this._0N=document.createElementNS(m,"g"),this._bEL=document.createElementNS(m,"g"),this._bOSB=document.createElementNS(m,"g"),this._bOSA=document.createElementNS(m,"g"),this._bOSF=document.createElementNS(m,"g"),this._bF=document.createElementNS(m,"g"),this._bDT=document.createElementNS(m,"g"),this._bC=document.createElementNS(m,"g"),this._1N=document.createElementNS(m,"g"),this._bISB=document.createElementNS(m,"g"),this._bISA=document.createElementNS(m,"g"),this._bISF=document.createElementNS(m,"g"),this._2N=document.createElementNS(m,"g"),this._iLB=document.createElementNS(m,"g"),this._hP=document.createElementNS(m,"g"),this._3N=document.createElementNS(m,"g"),this._iLA=document.createElementNS(m,"g"),this._fISB=document.createElementNS(m,"g"),this._fISA=document.createElementNS(m,"g"),this._fISF=document.createElementNS(m,"g"),this._fF=document.createElementNS(m,"g"),this._fDT=document.createElementNS(m,"g"),this._fC=document.createElementNS(m,"g"),this._4N=document.createElementNS(m,"g"),this._fOSB=document.createElementNS(m,"g"),this._fOSA=document.createElementNS(m,"g"),this._fOSF=document.createElementNS(m,"g"),this._5N=document.createElementNS(m,"g"),this._fEL=document.createElementNS(m,"g"),this._showHorizonPlane=!0,this._showGlobe=!1,"object"==typeof t&&(t.hasOwnProperty("showHorizonPlane")&&(this._showHorizonPlane=t.showHorizonPlane,delete t.showHorizonPlane),t.hasOwnProperty("showGlobe")&&(this._showGlobe=t.showGlobe,delete t.showGlobe),t.hasOwnProperty("onDraggingDidUpdate")&&(this._onDraggingDidUpdate=t.onDraggingDidUpdate,delete t.onDraggingDidUpdate),this.setParams(t)),this._hasUpdateBeenCalledEarly=!1,y.addInstance(this)}_initFailed(){console.error("Failed to initialize CelestialSphere instance."),this.update=this._updateFailedInstance,this._hasUpdateBeenCalledEarly&&this.update()}_initFinish(){this._element.appendChild(this._svg),this._createMasks(),this._svgGroup.appendChild(this._0N),this._svgGroup.appendChild(this._bEL),this._svgGroup.appendChild(this._bOSB),this._svgGroup.appendChild(this._bOSA),this._svgGroup.appendChild(this._bOSF),this._svgGroup.appendChild(this._bF),this._svgGroup.appendChild(this._bDT),this._svgGroup.appendChild(this._bC),this._svgGroup.appendChild(this._1N),this._svgGroup.appendChild(this._bISB),this._svgGroup.appendChild(this._bISA),this._svgGroup.appendChild(this._bISF),this._svgGroup.appendChild(this._2N),this._svgGroup.appendChild(this._iLB),this._svgGroup.appendChild(this._hP),this._svgGroup.appendChild(this._3N),this._svgGroup.appendChild(this._iLA),this._svgGroup.appendChild(this._fISB),this._svgGroup.appendChild(this._fISA),this._svgGroup.appendChild(this._fISF),this._svgGroup.appendChild(this._fF),this._svgGroup.appendChild(this._fDT),this._svgGroup.appendChild(this._fC),this._svgGroup.appendChild(this._4N),this._svgGroup.appendChild(this._fOSB),this._svgGroup.appendChild(this._fOSA),this._svgGroup.appendChild(this._fOSF),this._svgGroup.appendChild(this._5N),this._svgGroup.appendChild(this._fEL),this._interactiveArea=document.createElementNS(m,"circle"),this._interactiveArea.style.touchAction="none",this._interactiveArea.setAttribute("fill","rgba(255, 0 , 0, 0.0)"),this._svgGroup.appendChild(this._interactiveArea),this._belowHP=document.createElementNS(m,"g"),this._hP.appendChild(this._belowHP),this._aboveHP=document.createElementNS(m,"g"),this._hP.appendChild(this._aboveHP),this.setTheta(90),this.setPhi(20),this.setLatitude(41),this.setSiderealTime(0),this._shadingClips=[],this._horizonPlanes=[],this._globe=null,this._showGlobe&&this.addGlobe(),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerUp=this._onPointerUp.bind(this),this._onPointerCancel=this._onPointerCancel.bind(this),this.setInteractivity("standard"),this.sortObjects=!0,this._needs_updatePosition=!0,this._needs_updateShowMasks=!0,this._needs_updateShowUnder=!0,this.update=this._update,this._hasUpdateBeenCalledEarly&&this.update()}update(){this._hasUpdateBeenCalledEarly=!0}addGlobe(){this._globe=new d(this),this.registerElement(this._globe.getElement(),"__globe"),this.addObject("__globe",{position:{x:0,y:0,z:0,system:"celestial"},orientation:{type:"flat"},controller:this._globe})}getElement(){return this._element}getSVGGroup(){return this._svgGroup}setInteractivity(t){"standard"===t?(this._interactiveArea.setAttribute("display","inline"),this._interactiveArea.addEventListener("pointerdown",this._onPointerDown,{capture:!0,passive:!1})):this._interactiveArea.setAttribute("display","none")}_startStandardDragging(t){this._dragPointerId=t.pointerId,this._dragXMouse=t.layerX,this._dragYMouse=t.layerY,this._dragTheta=this._theta,this._dragPhi=this._phi,this._interactiveArea.setPointerCapture(this._dragPointerId),this._interactiveArea.addEventListener("pointermove",this._onPointerMove,{capture:!0,passive:!1}),this._interactiveArea.addEventListener("pointerup",this._onPointerUp),this._interactiveArea.addEventListener("pointercancel",this._onPointerCancel),t.preventDefault()}_updateStandardDragging(t){if(t.pointerId!==this._dragPointerId)return;const e=180/Math.PI*(this._dragTheta-(t.layerX-this._dragXMouse)/this._c.r),i=180/Math.PI*(this._dragPhi+(t.layerY-this._dragYMouse)/this._c.r);this.setTheta(e),this.setPhi(i),this.update(),null!==this._onDraggingDidUpdate&&this._onDraggingDidUpdate(),t.preventDefault()}_stopStandardDragging(t){if(t.pointerId===this._dragPointerId){this._interactiveArea.removeEventListener("pointermove",this._onPointerMove,{capture:!0,passive:!1}),this._interactiveArea.removeEventListener("pointerup",this._onPointerUp),this._interactiveArea.removeEventListener("pointercancel",this._onPointerCancel);try{this._interactiveArea.releasePointerCapture(this._dragPointerId)}catch(t){}}}_onPointerDown(t){this._startStandardDragging(t)}_onPointerMove(t){this._updateStandardDragging(t)}_onPointerUp(t){this._stopStandardDragging(t)}_onPointerCancel(t){this._stopStandardDragging(t)}setParams(t){if("object"==typeof t)for(const e in t)try{this["set"+e.charAt(0).toUpperCase()+e.slice(1)](t[e])}catch(t){console.error("Failed to set a property ("+e+").")}else console.warn("setParams called without object argument.")}_addHorizonPlane(t,e){if("below"==e)var i=this._belowHP;else i=this._aboveHP;const s=document.createElementNS(m,"image");s.setAttribute("href",t),s.setAttribute("width",210),s.setAttribute("height",210),s.setAttribute("x",-105),s.setAttribute("y",-105),i.appendChild(s),this._horizonPlanes.push(i)}_addShadingClip(t,e,i,s){this._shadingClips.push(t);const n=t.getElement();let h="_";h+="back"==e?"b":"f",h+="inner"==i?"I":"O",h+="S",h+="below"==s?"B":"above"==s?"A":"F",this[h].appendChild(n)}setPosition(t,e){this._x=t,this._y=e,this._needs_updatePosition=!0}setX(t){this._x=t,this._needs_updatePosition=!0}setY(t){this._y=t,this._needs_updatePosition=!0}setWidth(t){this._width=Math.round(t),this._needs_updateDimensions=!0}setHeight(t){this._height=Math.round(t),this._needs_updateDimensions=!0}getRadius(){return this._c.r}setRadius(t){t=Math.round(t),this._c.r=t,this._c.r2=t*t,this._doA(),this._doB(),this._needs_updateMasks=!0,this._needs_updateInteractiveArea=!0,this._needs_updateShading=!0,this._needs_updateHorizonPlane=!0,this._needs_updateObjects=!0,this._needs_updateCircles=!0,this._needs_updateLines=!0,this._needs_updateDeclinationTrails=!0,this._needs_updateShadedBands=!0}setSiderealTime(t){this._sTime=(t%24+24)%24*(Math.PI/12),this._doM(),this._doB(),this._needs_updateObjects=!0,this._needs_updateCircles=!0,this._needs_updateLines=!0,this._needs_updateDeclinationTrails=!0,this._needs_updateShadedBands=!0}setLatitude(t){t>90?t=90:t<-90&&(t=-90),this._lat=t*(Math.PI/180),this._doM(),this._doB(),this._needs_updateObjects=!0,this._needs_updateCircles=!0,this._needs_updateLines=!0,this._needs_updateDeclinationTrails=!0,this._needs_updateShadedBands=!0}getTheta(){return this._theta*(180/Math.PI)}setTheta(t){this._theta=Math.PI/180*((t%360+360)%360),this._doA(),this._doB(),this._needs_updateHorizonPlane=!0,this._needs_updateObjects=!0,this._needs_updateCircles=!0,this._needs_updateLines=!0,this._needs_updateDeclinationTrails=!0,this._needs_updateShadedBands=!0}setViewerAzimuth(t){this.setTheta(360-t)}getPhi(){return this._phi*(180/Math.PI)}setPhi(t){t>this._maxPhi?t=this._maxPhi:t<this._minPhi&&(t=this._minPhi),this._phi=t*(Math.PI/180),this._doA(),this._doB(),this._needs_updateMasks=!0,this._needs_updatePhi=!0,this._needs_updateInteractiveArea=!0,this._needs_updateHorizonPlane=!0,this._needs_updateObjects=!0,this._needs_updateCircles=!0,this._needs_updateLines=!0,this._needs_updateDeclinationTrails=!0,this._needs_updateShadedBands=!0}_updatePhi(){this._needs_updatePhi=!1}_updateFailedInstance(){this._element.style.backgroundColor="rgba(255, 0, 0, 0.5)"}_update(){if(this._needs_updateDimensions){this._element.style.width=this._width+"px",this._element.style.height=this._height+"px",this._svg.style.width=this._width+"px",this._svg.style.height=this._height+"px";const t=.5*this._width,e=.5*this._height;this._svg.setAttribute("viewBox","-"+t+" -"+e+" "+this._width+" "+this._height),this._needs_updateDimensions=!1}if(this._needs_updatePosition&&(this._element.style.left=this._x+"px",this._element.style.top=this._y+"px",this._needs_updatePosition=!1),this._needs_updateMasks&&this._updateMasks(),this._needs_updateInteractiveArea&&this._updateInteractiveArea(),this._needs_updateShowUnder&&this._updateShowUnder(),this._needs_updatePhi&&this._updatePhi(),this._needs_updateShading)for(let t of this._shadingClips)t.update();this._needs_updateHorizonPlane&&this._updateHorizonPlane(),this._needs_updateCircles&&this._updateCircles(),this._needs_updateLines&&this._updateLines(),this._updateObjects()}_updateInteractiveArea(){this._interactiveArea.setAttribute("r",this._c.r),this._needs_updateInteractiveArea=!1}_updateHorizonPlane(){const t=this._c.r/100,e=this._c.r*Math.sin(this._phi)/100,i=180+this._theta*(180/Math.PI);this._hP.setAttribute("transform","scale("+t+", "+e+") rotate( "+i+")"),this._phi>0?(this._aboveHP.setAttribute("display","inline"),this._belowHP.setAttribute("display","none")):(this._aboveHP.setAttribute("display","none"),this._belowHP.setAttribute("display","inline"))}screenToHorizon(t,e){this.StoMH(t,e),e.az=(360-e.az*(180/Math.PI))%360,e.alt=e.alt*(180/Math.PI)}screenToCelestial(t,e){var i=new Object;this.StoMH(t,i),this.MHtoC(i,e),e.ra=e.ra*(12/Math.PI),e.dec=e.dec*(180/Math.PI)}toScreen(t,e){var i=new Object;this.parsePointInput(t,i),0==i.sys||-1==i.sys?this.WtoSz(i,e):1==i.sys?this.CtoSz(i,e):(e.x=null,e.y=null,e.z=null)}pointToHorizon(t,e){var i={};if(this.parsePointInput(t,i),0==i.sys||-1==i.sys)(s=i.z/i.r)<-1?s=-1:s>1&&(s=1),e.az=c(-180/Math.PI*Math.atan2(i.y,i.x),360),e.alt=180/Math.PI*Math.asin(s),e.r=i.r;else if(1==i.sys){var s,n={};this.CtoW(i,n),(s=n.z/i.r)<-1?s=-1:s>1&&(s=1),e.az=c(-180/Math.PI*Math.atan2(n.y,n.x),360),e.alt=180/Math.PI*Math.asin(s),e.r=i.r}else e.az=null,e.alt=null,e.r=null}pointToCelestial(t,e){var i={};if(this.parsePointInput(t,i),0==i.sys||-1==i.sys){var s={};this.WtoC(i,s),(n=s.z/i.r)>1?n=1:n<-1&&(n=-1),e.ra=c(12/Math.PI*Math.atan2(s.y,s.x),24),e.dec=180/Math.PI*Math.asin(n),e.r=i.r}else if(1==i.sys){var n;(n=i.z/i.r)>1?n=1:n<-1&&(n=-1),e.ra=c(12/Math.PI*Math.atan2(i.y,i.x),24),e.dec=180/Math.PI*Math.asin(n),e.r=i.r}else e.ra=null,e.dec=null,e.r=null}parsePointInput(t,e){if(null!=t.az&&null!=t.alt){e.sys=0,e.system="horizon";var i=1;null!=t.r&&(i=t.r);var s=i*Math.cos(t.alt*(Math.PI/180));e.x=s*Math.cos(t.az*(Math.PI/180)),e.y=s*Math.sin(-t.az*(Math.PI/180)),e.z=i*Math.sin(t.alt*(Math.PI/180)),e.r=Math.abs(i)}else null!=t.ra&&null!=t.dec?(e.sys=1,e.system="celestial",i=1,null!=t.r&&(i=t.r),s=i*Math.cos(t.dec*(Math.PI/180)),e.x=s*Math.cos(t.ra*(Math.PI/12)),e.y=s*Math.sin(t.ra*(Math.PI/12)),e.z=i*Math.sin(t.dec*(Math.PI/180)),e.r=Math.abs(i)):null!=t.x&&null!=t.y&&null!=t.z?("horizon"==t.system?(e.sys=0,e.system="horizon"):"celestial"==t.system?(e.sys=1,e.system="celestial"):(e.sys=-1,e.system="unknown"),e.x=t.x,e.y=t.y,e.z=t.z,e.r=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z),e.r<1.000001&&e.r>.999999&&(e.r=1)):(e.sys=null,e.system=null,e.x=null,e.y=null,e.z=null,e.r=null)}WtoS(t,e){var i=this._c;e.x=t.x*i.a0+t.y*i.a1,e.y=t.x*i.a3+t.y*i.a4+t.z*i.a5}WtoSz(t,e){var i=this._c;e.x=t.x*i.a0+t.y*i.a1,e.y=t.x*i.a3+t.y*i.a4+t.z*i.a5,e.z=t.x*i.a6+t.y*i.a7+t.z*i.a8}CtoS(t,e){var i=this._c;e.x=t.x*i.b0+t.y*i.b1+t.z*i.b2,e.y=t.x*i.b3+t.y*i.b4+t.z*i.b5}CtoSz(t,e){var i=this._c;e.x=t.x*i.b0+t.y*i.b1+t.z*i.b2,e.y=t.x*i.b3+t.y*i.b4+t.z*i.b5,e.z=t.x*i.b6+t.y*i.b7+t.z*i.b8}CtoW(t,e){var i=this._c;e.x=t.x*i.m0+t.y*i.m1+t.z*i.m2,e.y=t.x*i.m3+t.y*i.m4,e.z=t.x*i.m6+t.y*i.m7+t.z*i.m8}WtoC(t,e){var i=this._c;e.x=t.x*i.m0+t.y*i.m3+t.z*i.m6,e.y=t.x*i.m1+t.y*i.m4+t.z*i.m7,e.z=t.x*i.m2+t.z*i.m8}CtoMH(t,e){var i=Math.sin(t.dec),s=Math.cos(t.dec),n=Math.sin(this._lat),h=Math.cos(this._lat),a=this._sTime-t.ra,r=Math.cos(a),_=i*h-s*r*n,o=s*Math.sin(a);e.az=0==_?0:c(Math.atan2(o,_),2*Math.PI),e.alt=Math.asin(i*n+s*r*h)}MHtoC(t,e){var i=Math.sin(t.alt),s=Math.cos(t.alt),n=Math.sin(t.az),h=Math.cos(t.az),a=Math.sin(this._lat),r=Math.cos(this._lat),_=s*n,o=i*r-s*a*h;e.ra=0==o?0:c(this._sTime-Math.atan2(_,o),2*Math.PI),e.dec=Math.asin(i*a+s*h*r)}StoMH(t,e){var i=Math,s=i.sqrt(t.x*t.x+t.y*t.y)/this._c.r;s>1&&(s=1);var n=i.asin(s),h=i.atan2(t.x,-t.y);if(this._phi==Math.PI/2)e.alt=Math.PI/2-n,e.az=this._theta+Math.PI-h;else if(this._phi==-Math.PI/2)e.alt=-Math.PI/2+n,e.az=this._theta+h;else{var a=Math.PI/2-this._phi,r=i.cos(a),_=i.sin(a),o=i.cos(n),l=i.sin(n),d=o*r+l*_*i.cos(h);e.alt=Math.PI/2-i.acos(d),e.az=this._theta+i.atan2(l*i.sin(h),(o-d*r)/_)}e.az=c(e.az,2*Math.PI)}_doA(){var t=this._c,e=Math.cos(this._theta),i=Math.sin(this._theta),s=Math.cos(this._phi),n=Math.sin(this._phi);t.a0=-t.r*i,t.a1=t.r*e,t.a3=t.r*e*n,t.a4=t.r*i*n,t.a5=-t.r*s,t.a6=t.r*e*s,t.a7=t.r*i*s,t.a8=t.r*n,this._aVer++}_doM(){var t=this._c;t.m2=Math.cos(this._lat),t.m3=Math.sin(this._sTime),t.m4=-Math.cos(this._sTime),t.m8=Math.sin(this._lat),t.m0=t.m4*t.m8,t.m1=-t.m3*t.m8,t.m6=-t.m2*t.m4,t.m7=t.m2*t.m3}_doB(){var t=this._c;t.b0=t.a0*t.m0+t.a1*t.m3,t.b1=t.a0*t.m1+t.a1*t.m4,t.b2=t.a0*t.m2,t.b3=t.a3*t.m0+t.a4*t.m3+t.a5*t.m6,t.b4=t.a3*t.m1+t.a4*t.m4+t.a5*t.m7,t.b5=t.a3*t.m2+t.a5*t.m8,t.b6=t.a6*t.m0+t.a7*t.m3+t.a8*t.m6,t.b7=t.a6*t.m1+t.a7*t.m4+t.a8*t.m7,t.b8=t.a6*t.m2+t.a8*t.m8,this._bVer++}_createMasks(){this._M0=document.createElementNS(m,"mask"),this._M0Id=this._htmlId+"-m0",this._M0.setAttribute("id",this._M0Id),this._M0path=document.createElementNS(m,"path"),this._M0path.setAttribute("fill","white"),this._M0path.setAttribute("stroke","none"),this._M0.appendChild(this._M0path),this._defs.appendChild(this._M0),this._M1=document.createElementNS(m,"mask"),this._M1Id=this._htmlId+"-m1",this._M1.setAttribute("id",this._M1Id),this._M1path=document.createElementNS(m,"path"),this._M1path.setAttribute("fill","white"),this._M1path.setAttribute("stroke","none"),this._M1.appendChild(this._M1path),this._defs.appendChild(this._M1),this._M2=document.createElementNS(m,"mask"),this._M2Id=this._htmlId+"-m2",this._M2.setAttribute("id",this._M2Id),this._M2path=document.createElementNS(m,"path"),this._M2path.setAttribute("fill","white"),this._M2path.setAttribute("stroke","none"),this._M2.appendChild(this._M2path),this._defs.appendChild(this._M2),this._M3=document.createElementNS(m,"mask"),this._M3Id=this._htmlId+"-m3",this._M3.setAttribute("id",this._M3Id),this._M3path=document.createElementNS(m,"path"),this._M3path.setAttribute("fill","white"),this._M3path.setAttribute("stroke","none"),this._M3.appendChild(this._M3path),this._defs.appendChild(this._M3),this._M4=document.createElementNS(m,"mask"),this._M4Id=this._htmlId+"-m4",this._M4.setAttribute("id",this._M4Id),this._M4path=document.createElementNS(m,"path"),this._M4path.setAttribute("fill","white"),this._M4path.setAttribute("stroke","none"),this._M4.appendChild(this._M4path),this._defs.appendChild(this._M4),this._M5=document.createElementNS(m,"mask"),this._M5Id=this._htmlId+"-m5",this._M5.setAttribute("id",this._M5Id),this._defs.appendChild(this._M5),this._needs_updateMasks=!0}_updateMasks(){const t=this._c.r,e=1.2*t,i=-e;this._M0path.setAttribute("d","M "+e+" "+e+" L "+e+" "+i+" "+i+" "+i+"  "+i+" "+e+" "+e+" "+e+" Z");const s=Math.PI/4,n=s/2,h=t/Math.cos(n),a=Math.sin(this._phi),r=t,_=a*t,o=h,l=a*h;let d="M "+e+" "+i+" L "+e+" 0 "+t+" 0",p="M "+e+" "+e+" L "+e+" 0 "+t+" 0",u="M "+e+" "+i+" L "+e+" 0 "+t+" 0",c="M "+e+" "+e+" L "+e+" 0 "+t+" 0",b=s,m=b-n;for(let t=0;t<4;t++){let t=r*Math.cos(b),e=_*Math.sin(b),i=-e,n=o*Math.cos(m),h=l*Math.sin(m),a=-h;d+=" Q "+n+" "+h+" "+t+" "+e,p+=" Q "+n+" "+h+" "+t+" "+e,u+=" Q "+n+" "+a+" "+t+" "+i,c+=" Q "+n+" "+a+" "+t+" "+i,b+=s,m+=s}const y=" L "+i+" 0 "+i+" "+i+" "+e+" "+i+" Z";d+=y,this._M1path.setAttribute("d",d),u+=y,this._M3path.setAttribute("d",u);const x=" L "+i+" 0 "+i+" "+e+" "+e+" "+e+" Z";p+=x,this._M2path.setAttribute("d",p),c+=x,this._M4path.setAttribute("d",c),this._needs_updateMasks=!1}_updateShowUnder(){this._showUnder?(this._bOSB.setAttribute("mask","url(#"+this._M4Id+")"),this._bOSA.setAttribute("mask","url(#"+this._M3Id+")"),this._bOSF.setAttribute("mask","url(#"+this._M0Id+")"),this._bF.setAttribute("mask","url(#"+this._M0Id+")"),this._bC.setAttribute("mask","url(#"+this._M0Id+")"),this._bISB.setAttribute("mask","url(#"+this._M4Id+")"),this._bISA.setAttribute("mask","url(#"+this._M3Id+")"),this._bISF.setAttribute("mask","url(#"+this._M0Id+")"),this._fISB.setAttribute("mask","url(#"+this._M2Id+")"),this._fISA.setAttribute("mask","url(#"+this._M1Id+")"),this._fISF.setAttribute("mask","url(#"+this._M0Id+")"),this._fF.setAttribute("mask","url(#"+this._M0Id+")"),this._fC.setAttribute("mask","url(#"+this._M0Id+")"),this._fOSB.setAttribute("mask","url(#"+this._M2Id+")"),this._fOSA.setAttribute("mask","url(#"+this._M1Id+")"),this._fOSF.setAttribute("mask","url(#"+this._M0Id+")")):(this._bOSB.setAttribute("mask","url(#"+this._M5Id+")"),this._bOSA.setAttribute("mask","url(#"+this._M3Id+")"),this._bOSF.setAttribute("mask","url(#"+this._M3Id+")"),this._bF.setAttribute("mask","url(#"+this._M3Id+")"),this._bC.setAttribute("mask","url(#"+this._M3Id+")"),this._bISB.setAttribute("mask","url(#"+this._M5Id+")"),this._bISA.setAttribute("mask","url(#"+this._M3Id+")"),this._bISF.setAttribute("mask","url(#"+this._M3Id+")"),this._fISB.setAttribute("mask","url(#"+this._M5Id+")"),this._fISA.setAttribute("mask","url(#"+this._M1Id+")"),this._fISF.setAttribute("mask","url(#"+this._M1Id+")"),this._fF.setAttribute("mask","url(#"+this._M1Id+")"),this._fC.setAttribute("mask","url(#"+this._M1Id+")"),this._fOSB.setAttribute("mask","url(#"+this._M5Id+")"),this._fOSA.setAttribute("mask","url(#"+this._M1Id+")"),this._fOSF.setAttribute("mask","url(#"+this._M1Id+")")),this._needs_updateShowUnder=!1}addCircle(t,e,i,s){var n=this._circleFreeID++;return this[t]=new h(this,t,n),this._circleList.push({id:n,name:this[t]}),"object"==typeof e&&this[t].setStyle(e.thickness,e.rgba),"object"==typeof i&&this[t].setParameters(i),this[t]}_updateCircles(t){if(t)for(var e=0;e<this._circleList.length;e++){var i=this._circleList[e].name;0==!i._sys&&i.update()}else for(e=0;e<this._circleList.length;e++)this._circleList[e].name.update()}addLine(t,e,i,s){var n=this._lineFreeID++;return this[t]=new r(this,t,n,e,i,s),this._lineList.push({id:n,name:this[t]}),this[t]}_updateLines(t){if(t)for(var e=0;e<this._lineList.length;e++){var i=this._lineList[e].name;0==i._head.sys&&0==i._tail.sys||i.update()}else for(e=0;e<this._lineList.length;e++)this._lineList[e].name.update()}registerElement(t,e){let i=this._htmlId+"-obj-"+e;t.setAttribute("id",i),this._defs.appendChild(t);let s={element:t,fullRefId:i};this._objectElements.push(s)}addObject(t,e,i){let s=this._htmlId+"-obj-"+t,n=null;null!=i&&(n=this._htmlId+"-obj-"+i);let h=new o(this,s,e,n);var a=this._objectFreeID++;return this._objectList.push({id:a,obj:h}),h}_updateObjects(){for(var t=[],e=[],i=[],s=[],n=[],h=[],a=!this._showUnder,r=this._objectList,_=0;_<r.length;_++){var o=r[_].obj;if(o._visible){if(o._r>1){if(a){var l={};if(0==o._sys?l=o._p:1==o._sys&&this.CtoW(o._p,l),l.z<0){o._outerElement.setAttribute("display","none");continue}o._outerElement.setAttribute("display","inline"),this.WtoSz(l,o._sp)}else o._outerElement.setAttribute("display","inline"),0==o._sys?this.WtoSz(o._p,o._sp):1==o._sys&&this.CtoSz(o._p,o._sp);o._sp.z<0?t.push([o._sp.z,o._outerElement]):h.push([o._sp.z,o._outerElement])}else if(o._r<1){if(l={},0==o._sys?l=o._p:1==o._sys&&this.CtoW(o._p,l),a&&l.z<0){o._outerElement.setAttribute("display","none");continue}o._outerElement.setAttribute("display","inline"),this.WtoSz(l,o._sp),l.z<0?i.push([o._sp.z,o._outerElement]):s.push([o._sp.z,o._outerElement])}else{if(a){if(l={},0==o._sys?l=o._p:1==o._sys&&this.CtoW(o._p,l),l.z<0){o._outerElement.setAttribute("display","none");continue}o._outerElement.setAttribute("display","inline"),this.WtoSz(l,o._sp)}else o._outerElement.setAttribute("display","inline"),0==o._sys?this.WtoSz(o._p,o._sp):1==o._sys&&this.CtoSz(o._p,o._sp);o._sp.z<0?e.push([o._sp.z,o._outerElement]):n.push([o._sp.z,o._outerElement])}o.update()}}t.sort(this.sortRegion),e.sort(this.sortRegion),i.sort(this.sortRegion),s.sort(this.sortRegion),n.sort(this.sortRegion),h.sort(this.sortRegion);for(const e of t)this._0N.appendChild(e[1]);for(const t of e)this._1N.appendChild(t[1]);if(this._phi<0){for(const t of i)this._3N.appendChild(t[1]);for(const t of s)this._2N.appendChild(t[1])}else{for(const t of i)this._2N.appendChild(t[1]);for(const t of s)this._3N.appendChild(t[1])}for(const t of n)this._4N.appendChild(t[1]);for(const t of h)this._5N.appendChild(t[1]);this._needs_updateObjects=!1}sortRegion(t,e){return t[0]<e[0]?-1:t[0]==e[0]?0:t[0]>e[0]?1:void 0}}var x=0;const g="http://www.w3.org/2000/svg";class z{constructor(t){this._parent=t.parent,this._innerRGBA="#FF0000CC",this._outerRGBA="#FF00FF66",t.hasOwnProperty("innerRGBA")&&(this._innerRGBA=t.innerRGBA),t.hasOwnProperty("outerRGBA")&&(this._outerRGBA=t.outerRGBA),this._htmlId=this._parent._htmlId+"-gd"+x++,this._element=document.createElementNS(g,"g");const e=document.createElementNS(g,"defs");this._element.appendChild(e);const i=document.createElementNS(g,"radialGradient");i.setAttribute("id",this._htmlId),e.appendChild(i),this._innerStop=document.createElementNS(g,"stop"),this._innerStop.setAttribute("offset","0%"),i.appendChild(this._innerStop),this._outerStop=document.createElementNS(g,"stop"),this._outerStop.setAttribute("offset","100%"),i.appendChild(this._outerStop),this._disk=document.createElementNS(g,"circle"),this._disk.setAttribute("cx",0),this._disk.setAttribute("cy",0),this._disk.setAttribute("fill","url(#"+this._htmlId+")"),this._element.appendChild(this._disk),this._lastRadius=-1,this._needs_updateGradient=!0}getElement(){return this._element}update(){if(this._needs_updateGradient&&(this._innerStop.setAttribute("stop-color",this._innerRGBA),this._outerStop.setAttribute("stop-color",this._outerRGBA),this._needs_updateGradient=!1),this._parent._c.r!==this._lastRadius){const t=this._parent._c.r;this._disk.setAttribute("r",t),this._lastRadius=t}}}var f=i(686);e()(f.Z,{insert:"head",singleton:!1}),f.Z.locals;const v="http://www.w3.org/2000/svg";class S{constructor(t){this._isOpen=t.isOpen,this._onToggleIsOpen=t.onToggleIsOpen,this._element=document.createElement("button"),this._element.classList.add("q-openclose"),this._element.addEventListener("click",this._onToggleIsOpen),this._iconSVG=document.createElementNS(v,"svg"),this._iconSVG.setAttribute("viewBox","0 0 32 32"),this._iconSVG.classList.add("q-openclose-svg"),this._element.appendChild(this._iconSVG),this._lines=document.createElementNS(v,"path"),this._lines.setAttribute("fill","none"),this._lines.setAttribute("stroke","rgb(0, 0, 0)"),this._lines.setAttribute("stroke-width",2),this._iconSVG.appendChild(this._lines),this._x=0,this._y=0,this._width=100,this._height=100,this._needs_updateLayout=!0,this._needs_updateIsOpen=!0}setIsOpen(t){this._isOpen=t,this._needs_updateIsOpen=!0}getElement(){return this._element}setPosition(t,e){this._x=t,this._y=e,this._needs_updateLayout=!0}setDimensions(t,e){this._width=t,this._height=e,this._needs_updateLayout=!0}update(){this._needs_updateLayout&&this._updateLayout(),this._needs_updateIsOpen&&this._updateIsOpen()}_updateIsOpen(){let t;t=this._isOpen?"M 8 12 L 16 20 24 12":"M 8 20 L 16 12 24 20",this._lines.setAttribute("d",t),this._needs_updateIsOpen=!1}_updateLayout(){this._element.style.left=this._x+"px",this._element.style.top=this._y+"px",this._element.style.width=this._width+"px",this._element.style.height=this._height+"px",this._iconSVG.style.width=this._width+"px",this._iconSVG.style.height=this._height+"px",this._needs_updateLayout=!1}}const M="http://www.w3.org/2000/svg";class w{constructor(t){this._dir=t.dir,this._onNav=t.onNav,this._element=document.createElement("button"),this._element.classList.add("q-nav"),this._element.addEventListener("click",this._onNav),this._iconSVG=document.createElementNS(M,"svg"),this._iconSVG.setAttribute("viewBox","0 0 32 32"),this._iconSVG.classList.add("q-openclose-svg"),this._element.appendChild(this._iconSVG),this._lines=document.createElementNS(M,"path"),this._lines.setAttribute("fill","rgb(80, 80, 80)"),this._lines.setAttribute("stroke","none"),this._lines.setAttribute("stroke-width",2),"left"===this._dir?this._lines.setAttribute("d","M 24 6 L 8 16 24 26 Z"):this._lines.setAttribute("d","M 8 6 L 24 16 8 26 Z"),this._iconSVG.appendChild(this._lines),this._x=0,this._y=0,this._width=100,this._height=100,this._needs_updateLayout=!0}getElement(){return this._element}setDimensions(t,e){this._width=t,this._height=e,this._needs_updateLayout=!0}update(){this._needs_updateLayout&&this._updateLayout()}_updateLayout(){this._element.style.width=this._width+"px",this._element.style.height=this._height+"px",this._iconSVG.style.width=this._width+"px",this._iconSVG.style.height=this._height+"px",this._needs_updateLayout=!1}}class P{constructor(t){this._wasUpdateCalledEarly=!1,this._root=t.root,this._questionsSet=t.questionsSet,this._setPreset=t.setPreset,this._setQuestionState=t.setQuestionState,this._onHeightChanged=t.onHeightChanged,this._element=document.createElement("div"),this._isOpen=!1,this._x=0,this._y=0,this._width=100,this._height=100,this._needs_updateLayout=!0,this._needs_updateIsOpen=!0,this._needs_updateSelection=!0,this._needs_updateInnerLayout=!0,this._questions=[],this._index=0,this._selectionObj=null,this._sectionTitle="...",this._abbrDiv=document.createElement("div"),this._abbrDiv.classList.add("q-abbr"),this._fullDiv=document.createElement("div"),this._fullDiv.classList.add("q-full"),this._fullDivTopLine=document.createElement("div"),this._fullDivTopLine.classList.add("q-full-topline"),this._fullDivQContent=document.createElement("div"),this._fullDiv.appendChild(this._fullDivTopLine),this._fullDiv.appendChild(this._fullDivQContent),this._element.classList.add("q"),this._inner=document.createElement("div"),this._inner.classList.add("q-inner"),this._element.appendChild(this._inner),this._onSetupButtonClicked=this._onSetupButtonClicked.bind(this),this._setupButton=document.createElement("button"),this._setupButton.classList.add("btn"),this._setupButton.classList.add("btn-primary"),this._setupButton.classList.add("q-preset-btn"),this._setupButton.textContent="Set Up",this._setupButton.addEventListener("click",this._onSetupButtonClicked),this._onToggleIsOpen=this._onToggleIsOpen.bind(this),this._button=new S({isOpen:this._isOpen,onToggleIsOpen:this._onToggleIsOpen}),this._inner.appendChild(this._button.getElement()),this._goToPrevQuestion=this._goToPrevQuestion.bind(this),this._goToNextQuestion=this._goToNextQuestion.bind(this),this._navLeft=new w({dir:"left",onNav:this._goToPrevQuestion}),this._fullDivTopLine.appendChild(this._navLeft.getElement()),this._navTitle=document.createElement("span"),this._navTitle.classList.add("q-nav-title"),this._fullDivTopLine.appendChild(this._navTitle),this._navRight=new w({dir:"right",onNav:this._goToNextQuestion}),this._fullDivTopLine.appendChild(this._navRight.getElement()),this._content=document.createElement("div"),this._content.classList.add("q-content"),this._inner.appendChild(this._content)}_onSetupButtonClicked(){const t=this._questions[this._index];"object"==typeof t&&t.state.hasOwnProperty("preset")&&this._setPreset(t.state.preset)}_goToPrevQuestion(){const t=this._questions.length;this._index=((this._index-1)%t+t)%t,this._needs_updateSelection=!0,this.update()}_goToNextQuestion(){this._index=(this._index+1)%this._questions.length,this._needs_updateSelection=!0,this.update()}setSectionTitle(t){this._sectionTitle=t,this._needs_updateSelection=!0}setSelection(t,e,i,s){this._selectionNum=t,this._questions=this._questionsSet[e],void 0===this._questions&&(this._questions=[]),this._selectionObj=i,this._index=this._questions.findIndex((t=>t.id===s)),-1===this._index&&(this._index=0),this._needs_updateSelection=!0}_onToggleIsOpen(){this._isOpen=!this._isOpen,this._needs_updateLayout=!0,this._needs_updateIsOpen=!0,this.update()}close(){this._isOpen=!1,this._needs_updateLayout=!0,this._needs_updateIsOpen=!0,this.update()}getElement(){return this._element}setPosition(t,e){this._x=Math.floor(t),this._y=Math.floor(e),this._needs_updateLayout=!0}setDimensions(t,e){this._width=Math.floor(t),this._height=Math.floor(e),this._needs_updateLayout=!0}update(){this._needs_updateLayout&&this._updateLayout(),this._needs_updateSelection&&this._updateSelection(),this._needs_updateIsOpen&&this._updateIsOpen(),this._needs_updateInnerLayout&&this._updateInnerLayout(),this._button.update()}getHeight(){return this._actualHeight}_updateSelection(){for(this._needs_updateInnerLayout=!0;null!==this._abbrDiv.lastChild;)this._abbrDiv.removeChild(this._abbrDiv.lastChild);for(;null!==this._fullDivQContent.lastChild;)this._fullDivQContent.removeChild(this._fullDivQContent.lastChild);let t=!1;const e=this._questions[this._index];if("object"==typeof e){e.state.hasOwnProperty("preset")&&this._fullDivQContent.appendChild(this._setupButton);const i=String.fromCodePoint(65+this._index),s=this._selectionNum+i,n=document.createElement("p"),h=document.createElement("b");h.textContent="Q"+s+": ",n.appendChild(h);const a=document.createElement("span"),r=60;if(e.paras[0].length<r)e.paras.length>1?a.textContent=e.paras[0]+"...":a.textContent=e.paras[0];else{let t=e.paras[0].lastIndexOf(" ",r);-1===t&&(t=r),a.textContent=e.paras[0].slice(0,t)+"..."}n.appendChild(a),this._abbrDiv.appendChild(n),""!==this._sectionTitle?this._navTitle.textContent="Q"+s+" - "+this._sectionTitle+" - "+(this._index+1)+" of "+this._questions.length:this._navTitle.textContent="Q"+s+"  - "+(this._index+1)+" of "+this._questions.length;for(const t of e.paras){const e=document.createElement("p");e.textContent=t,this._fullDivQContent.appendChild(e)}t=!0}else{this._navTitle.textContent=this._sectionTitle+": No Questions";let t=document.createElement("span");t.textContent="...",this._abbrDiv.appendChild(t),t=document.createElement("p"),t.textContent="...",this._fullDivQContent.appendChild(t)}this._needs_updateSelection=!1,t&&this._setQuestionState(e.state)}_updateIsOpen(){this._needs_updateInnerLayout=!0,this._button.setIsOpen(this._isOpen),this._isOpen?(this._content.contains(this._abbrDiv)&&this._content.removeChild(this._abbrDiv),this._content.contains(this._fullDiv)||this._content.appendChild(this._fullDiv)):(this._content.contains(this._abbrDiv)||this._content.appendChild(this._abbrDiv),this._content.contains(this._fullDiv)&&this._content.removeChild(this._fullDiv)),this._needs_updateIsOpen=!1}_updateInnerLayout(){if(this._isOpen){const t=this._fullDiv.getBoundingClientRect(),e=Math.max(t.height+20,this._height);this._inner.style.top=this._height-e+"px",this._content.style.height=e+"px",this._inner.style.height=e+"px",this._actualHeight=e}else this._inner.style.top="0px",this._content.style.height=this._height+"px",this._inner.style.height=this._height+"px",this._actualHeight=this._height;this._onHeightChanged(this._actualHeight),this._needs_updateInnerLayout=!1}_updateLayout(){this._needs_updateInnerLayout=!0,this._element.style.width=this._width+"px",this._element.style.height=this._height+"px",this._inner.style.width=this._width+"px",this._inner.style.height=this._height+"px",this._buttonSize=this._height,this._button.setDimensions(this._buttonSize,this._buttonSize);const t=this._height,e=this._height;let i,s;this._navLeft.setDimensions(t,e),this._navLeft.update(),this._navRight.setDimensions(t,e),this._navRight.update(),this._isOpen?(i=0,s=this._width-i+"px"):(i=this._buttonSize+0,s=this._width-i-0+"px"),this._content.style.left=i+"px",this._content.style.width=s,this._fullDiv.style.width=s,this._needs_updateLayout=!1}}const I="http://www.w3.org/2000/svg";new class{constructor(){this._onAnimationFrame=this._onAnimationFrame.bind(this),this._onDraggingDidUpdate=this._onDraggingDidUpdate.bind(this),this._sphere=new y({showHorizonPlane:!1,onDraggingDidUpdate:this._onDraggingDidUpdate}),this._sphere.setLatitude(90),this._sphere.setSiderealTime(0);const t=new z({parent:this._sphere,innerRGBA:"#e1e1e108",outerRGBA:"#e1e1e120"});this._sphere._addShadingClip(t,"front","inner","both");const e=new z({parent:this._sphere,innerRGBA:"#e1e1e108",outerRGBA:"#e1e1e120"});this._sphere._addShadingClip(e,"back","inner","both"),this._sphere.addCircle("horizonCircle",{thickness:1,rgba:"#FFFFFF50"},{az:0,alt:0,tilt:0}),this._sphere.addCircle("meridianCircle1",{thickness:1,rgba:"#FFFFFF50"},{az:0,alt:0,tilt:0}),this._sphere.addCircle("meridianCircle2",{thickness:1,rgba:"#FFFFFF50"},{az:0,alt:0,tilt:0}),this._sphere.addCircle("zeroHoursCircle",{thickness:1,rgba:"#FFE375b0"},{ra:0,dec:0,tilt:90,gammaStart:-90,gammaEnd:90}),this._sphere.addCircle("celestialEquator",{thickness:1,rgba:"#FFE375b0"},{ra:0,dec:0,tilt:0}),this._sphere.addLine("ncpAxis",{thickness:2,color:"#75A9FFff"},{x:0,y:0,z:1,system:"celestial"},{x:0,y:0,z:1.2,system:"celestial"}),this._sphere.addLine("scpAxis",{thickness:2,color:"#75A9FFff"},{x:0,y:0,z:-1,system:"celestial"},{x:0,y:0,z:-1.2,system:"celestial"});const i=document.createElementNS(I,"g"),s=document.createElementNS(I,"circle");s.setAttribute("fill","#87b837"),s.setAttribute("stroke","none"),s.setAttribute("cx",0),s.setAttribute("cy",0),s.setAttribute("r",100),i.appendChild(s);const n=document.createElementNS(I,"text");n.setAttribute("x",-10.16),n.setAttribute("y",-71.5),n.setAttribute("font-family","sans-serif"),n.setAttribute("font-weight","bold"),n.setAttribute("font-size","24px"),n.setAttribute("line-height",1.25),n.setAttribute("fill","white"),i.appendChild(n),this._aboveNLabel=document.createElementNS(I,"tspan"),this._aboveNLabel.style.webkitUserSelect="none",this._aboveNLabel.style.userSelect="none",this._aboveNLabel.textContent="N",n.appendChild(this._aboveNLabel);const h=document.createElementNS(I,"text");h.setAttribute("x",75.34),h.setAttribute("y",8.72),h.setAttribute("font-family","sans-serif"),h.setAttribute("font-weight","bold"),h.setAttribute("font-size","24px"),h.setAttribute("line-height",1.25),h.setAttribute("fill","white"),i.appendChild(h),this._aboveELabel=document.createElementNS(I,"tspan"),this._aboveELabel.style.webkitUserSelect="none",this._aboveELabel.style.userSelect="none",this._aboveELabel.textContent="E",h.appendChild(this._aboveELabel);const a=document.createElementNS(I,"text");a.setAttribute("x",-90.16),a.setAttribute("y",8.72),a.setAttribute("font-family","sans-serif"),a.setAttribute("font-weight","bold"),a.setAttribute("font-size","24px"),a.setAttribute("line-height",1.25),a.setAttribute("fill","white"),i.appendChild(a),this._aboveWLabel=document.createElementNS(I,"tspan"),this._aboveWLabel.style.webkitUserSelect="none",this._aboveWLabel.style.userSelect="none",this._aboveWLabel.textContent="W",a.appendChild(this._aboveWLabel);const r=document.createElementNS(I,"text");r.setAttribute("x",-8.74),r.setAttribute("y",88.72),r.setAttribute("font-family","sans-serif"),r.setAttribute("font-weight","bold"),r.setAttribute("font-size","24px"),r.setAttribute("line-height",1.25),r.setAttribute("fill","white"),i.appendChild(r),this._aboveSLabel=document.createElementNS(I,"tspan"),this._aboveSLabel.style.webkitUserSelect="none",this._aboveSLabel.style.userSelect="none",this._aboveSLabel.textContent="S",r.appendChild(this._aboveSLabel),this._tangentPlaneAboveElement=i;const _=document.createElementNS(I,"g"),o=document.createElementNS(I,"circle");o.setAttribute("fill","#568111"),o.setAttribute("stroke","none"),o.setAttribute("cx",0),o.setAttribute("cy",0),o.setAttribute("r",100),_.appendChild(o);const l="#cccccc",d=document.createElementNS(I,"text");d.setAttribute("x",-10.16),d.setAttribute("y",-71.5),d.setAttribute("font-family","sans-serif"),d.setAttribute("font-weight","bold"),d.setAttribute("font-size","24px"),d.setAttribute("line-height",1.25),d.setAttribute("fill",l),_.appendChild(d),this._belowNLabel=document.createElementNS(I,"tspan"),this._belowNLabel.style.webkitUserSelect="none",this._belowNLabel.style.userSelect="none",this._belowNLabel.textContent="N",d.appendChild(this._belowNLabel);const p=document.createElementNS(I,"text");p.setAttribute("x",75.34),p.setAttribute("y",8.72),p.setAttribute("font-family","sans-serif"),p.setAttribute("font-weight","bold"),p.setAttribute("font-size","24px"),p.setAttribute("line-height",1.25),p.setAttribute("fill",l),_.appendChild(p),this._belowELabel=document.createElementNS(I,"tspan"),this._belowELabel.style.webkitUserSelect="none",this._belowELabel.style.userSelect="none",this._belowELabel.textContent="E",p.appendChild(this._belowELabel);const u=document.createElementNS(I,"text");u.setAttribute("x",-90.16),u.setAttribute("y",8.72),u.setAttribute("font-family","sans-serif"),u.setAttribute("font-weight","bold"),u.setAttribute("font-size","24px"),u.setAttribute("line-height",1.25),u.setAttribute("fill",l),_.appendChild(u),this._belowWLabel=document.createElementNS(I,"tspan"),this._belowWLabel.style.webkitUserSelect="none",this._belowWLabel.style.userSelect="none",this._belowWLabel.textContent="W",u.appendChild(this._belowWLabel);const c=document.createElementNS(I,"text");c.setAttribute("x",-8.74),c.setAttribute("y",88.72),c.setAttribute("font-family","sans-serif"),c.setAttribute("font-weight","bold"),c.setAttribute("font-size","24px"),c.setAttribute("line-height",1.25),c.setAttribute("fill",l),_.appendChild(c),this._belowSLabel=document.createElementNS(I,"tspan"),this._belowSLabel.style.webkitUserSelect="none",this._belowSLabel.style.userSelect="none",this._belowSLabel.textContent="S",c.appendChild(this._belowSLabel),this._tangentPlaneAboveElement=i,this._sphere.registerElement(this._tangentPlaneAboveElement,"tangentPlaneAboveElement"),this._tangentPlaneBelowElement=_,this._sphere.registerElement(this._tangentPlaneBelowElement,"tangentPlaneBelowElement"),this._tangentPlaneAboveElement.setAttribute("width",210),this._tangentPlaneAboveElement.setAttribute("height",210),this._tangentPlaneAboveElement.setAttribute("x",-105),this._tangentPlaneAboveElement.setAttribute("y",-105),this._tangentPlaneBelowElement.setAttribute("width",210),this._tangentPlaneBelowElement.setAttribute("height",210),this._tangentPlaneBelowElement.setAttribute("x",-105),this._tangentPlaneBelowElement.setAttribute("y",-105),this._tangentPlaneAbove=this._sphere.addObject("tangentPlaneAboveElement",{position:{az:0,alt:0},orientation:{type:"absolute"}},"tangentPlaneBelowElement"),this._currHorizonPlaneLabelsState="A",this._stickmanScaleMultiplier=1.7,this._stickmanElement=document.createElementNS(I,"g");const b="black",m=document.createElementNS(I,"path");m.setAttribute("stroke-width",1),m.setAttribute("stroke",b),m.setAttribute("stroke-linecap","round"),m.setAttribute("fill","none"),m.setAttribute("d","M -2.5 0 L 0 -5 2.5 0 M 0 -5 L 0 -11.5 M -2.5 -7.5 L 0 -8.5 2.5 -7.5"),this._stickmanElement.appendChild(m);const x=document.createElementNS(I,"circle");x.setAttribute("stroke-width",1),x.setAttribute("stroke",b),x.setAttribute("fill","white"),x.setAttribute("cx",0),x.setAttribute("cy",-11.5),x.setAttribute("r",1.8),this._stickmanElement.appendChild(x),this._sphere.registerElement(this._stickmanElement,"stickmanElement"),this._stickman=this._sphere.addObject("stickmanElement",{position:{az:0,alt:0},orientation:{type:"skewed"}}),this._globeSphere=new y({showHorizonPlane:!1,showGlobe:!0}),this._globeSphere.setInteractivity("none"),this._globeSphere.setLatitude(90),this._globeSphere.setSiderealTime(0),this._dotElement=document.createElementNS(I,"circle"),this._dotElement.setAttribute("fill","white"),this._dotElement.setAttribute("stroke","black"),this._globeSphere.registerElement(this._dotElement,"dot"),this._dot=this._globeSphere.addObject("dot",{position:{az:0,alt:0}}),this._globeSphere.addCircle("longitudeCircle",{thickness:1,rgba:"#707070ff"},{alt:0,az:0,tilt:90,gammaStart:90,gammaEnd:-90}),this._globeSphere.addCircle("latitudeCircle",{thickness:1,rgba:"#707070ff"},{alt:0,az:0,tilt:0}),this._sphere.registerElement(this._globeSphere.getSVGGroup(),"globeSphereElement"),this._globeSphereObj=this._sphere.addObject("globeSphereElement",{position:{x:0,y:0,z:.001,system:"horizon"}}),this._onLatitudeChanged=this._onLatitudeChanged.bind(this),this._latitudeSlider=document.getElementById("chs-latitude-slider"),this._latitudeSlider.addEventListener("input",this._onLatitudeChanged),this._doSwitch=this._doSwitch.bind(this),this._switchButton=document.getElementById("chs-switch-button"),this._switchButton.addEventListener("click",this._doSwitch),this._latitudeDisplay=document.getElementById("chs-latitude-display"),this._celestialLabel=document.getElementById("chs-celestial-label"),this._horizonLabel=document.getElementById("chs-horizon-label"),this._horizonArrowHorizontal=document.getElementById("chs-horizon-arrow-horizontal"),this._horizonArrowVertical=document.getElementById("chs-horizon-arrow-vertical"),this._celestialArrowHorizontal=document.getElementById("chs-celestial-arrow-horizontal"),this._celestialArrowVertical=document.getElementById("chs-celestial-arrow-vertical"),this._bottomSpacer=document.getElementById("chs-spacer"),this._root=document.getElementById("chs-root"),this._sphereContainer=document.getElementById("chs-sphere"),this._switchContainer=document.getElementById("chs-switch-container");const g=this._sphereContainer.getBoundingClientRect();this._sphereContainerWidth=Math.floor(g.width),this._sphereContainerHeight=Math.floor(g.height),this._sphereContainer.appendChild(this._sphere.getElement()),this._onWindowResize=this._onWindowResize.bind(this),window.addEventListener("resize",this._onWindowResize),this._latitude=this._latitudeSlider.valueAsNumber,this._transitionDirection=1,this._transitionParameter=1,this._transitionIsInOrientationPhase=!1,this._transitionPhaseParameter=1,this._transitionDuration=4e3,this._globeRadius=100,this._controlsContainer=document.getElementById("chs-controls"),this._setPreset=this._setPreset.bind(this),this._setQuestionState=this._setQuestionState.bind(this),this._onQuestionsHeightChanged=this._onQuestionsHeightChanged.bind(this);this._questions=null,this._questionsContainer=document.getElementById("questions-container"),null!==this._questionsContainer&&(this._questions=new P({root:this,setPreset:this._setPreset,setQuestionState:this._setQuestionState,questionsSet:{primary:[{id:"p1",state:{},paras:["What percentage of the celestial sphere (of the stars in the sky) can an observer typically see?"]},{id:"p2",state:{},paras:["For each of the following latitudes [40° N, 70° N, 13° S, 47° S, the equator], what celestial pole is seen in the sky and where is it seen?"]},{id:"p3",state:{},paras:["Specify a general rule describing what pole an observer sees in the sky and where they see it that will work for all latitudes."]}]},onHeightChanged:this._onQuestionsHeightChanged}),this._questionsContainer.appendChild(this._questions.getElement()),this._questions.setSectionTitle(""),this._questions.setSelection(1,"primary",null,null)),this._windowWidth=window.innerWidth,this._windowHeight=window.innerHeight,this._questionsReservedHeight=42,this._needs_updateLayout=!0,this._needs_updateLatitude=!0,this._needs_updateTransition=!0,this.update()}_setPreset(){}_setQuestionState(){}_onQuestionsHeightChanged(t){console.log("onQuestionsHeightChanged, "+t),this._bottomSpacer.style.height=t-this._questionsReservedHeight+"px"}_doSwitch(){1===this._transitionDirection?this._animationTimeStart=performance.now()-this._transitionDuration*(1-this._transitionParameter):this._animationTimeStart=performance.now()-this._transitionDuration*(this._transitionParameter-.001),this._transitionDirection*=-1,this._animationFrameId=window.requestAnimationFrame(this._onAnimationFrame)}_onAnimationFrame(t){let e=(t-this._animationTimeStart)/this._transitionDuration;e>1?e=1:this._animationFrameId=window.requestAnimationFrame(this._onAnimationFrame),1!==this._transitionDirection&&(e=1-e),e<.001?e=.001:e>1&&(e=1);this._transitionIsInOrientationPhase=e<.3,this._transitionParameter=e,this._transitionIsInOrientationPhase?this._transitionPhaseParameter=e/.3:this._transitionPhaseParameter=(e-.3)/.7,this._needs_updateTransition=!0,this.update()}_onDraggingDidUpdate(){this._globeSphere.setTheta(this._sphere.getTheta()),this._globeSphere.setPhi(this._sphere.getPhi()),this._globeSphere.update()}_onLatitudeChanged(){this._latitude=this._latitudeSlider.valueAsNumber,this._needs_updateLatitude=!0,this.update()}_onWindowResize(){const t=window.innerWidth,e=window.innerHeight;t===this._windowWidth&&e===this._windowHeight||(this._windowWidth=t,this._windowHeight=e,console.log("onWindowResize, "+this._windowWidth+", "+this._windowHeight),this._needs_updateLayout=!0,this.update())}update(){if(this._needs_updateLayout){this._needs_updateTransition=!0;const t=this._controlsContainer.getBoundingClientRect();this._controlsHeight=t.height;const e=this._windowWidth,i=300;this._sphereContainerWidth=Math.floor(Math.max(i,Math.min(e,this._windowHeight-this._controlsHeight))),this._sphereContainerHeight=this._sphereContainerWidth;let s=Math.floor(20*Math.max(0,Math.min(1,(this._sphereContainerHeight-450)/200)));s>0&&(this._sphereContainerHeight=this._sphereContainerHeight-2*s,this._sphereContainerWidth=this._sphereContainerHeight),this._sphereContainer.style.marginTop=s+"px",this._sphereContainer.style.marginBottom=s+"px",this._sphereContainer.style.width=this._sphereContainerWidth+"px",this._sphereContainer.style.height=this._sphereContainerWidth+"px";const n=.4,h=.3;if(this._sphereRadius=.5*Math.round(2*n*this._sphereContainerWidth),this._sphere.setWidth(this._sphereContainerWidth),this._sphere.setHeight(this._sphereContainerHeight),this._sphere.setRadius(this._sphereRadius),this._globeMaxRadius=Math.round(h*this._sphereRadius),this._globeSphere.setWidth(h*this._sphereContainerWidth),this._globeSphere.setHeight(h*this._sphereContainerHeight),null!==this._questions){const t=42;this._questions.setDimensions(this._windowWidth,t),this._questions.setPosition(0,this._windowHeight-t)}this._needs_updateLayout=!1}if(this._needs_updateSwitchLayout&&(this._needs_updateSwitchLayout=!1),this._needs_updateTransition&&this._updateTransition(),(this._needs_updateLatitude||this._needs_updateSphereLatitude)&&this._updateSphereLatitude(),this._needs_updateLatitude){let t;this._needs_updateTangentPlane=!0;let e=Math.abs(this._latitude);t=this._latitude<0?e.toFixed(1)+"° S":e.toFixed(1)+"° N",this._latitudeDisplay.textContent="Latitude: "+t;let i="A";if(this._latitude<-89.9?i="N":this._latitude>89.9&&(i="S"),this._currHorizonPlaneLabelsState!==i&&("S"===i?(this._aboveNLabel.textContent="S",this._aboveELabel.textContent="S",this._aboveWLabel.textContent="S",this._aboveSLabel.textContent="S",this._belowNLabel.textContent="S",this._belowELabel.textContent="S",this._belowWLabel.textContent="S",this._belowSLabel.textContent="S"):"N"===i?(this._aboveNLabel.textContent="N",this._aboveELabel.textContent="N",this._aboveWLabel.textContent="N",this._aboveSLabel.textContent="N",this._belowNLabel.textContent="N",this._belowELabel.textContent="N",this._belowWLabel.textContent="N",this._belowSLabel.textContent="N"):(this._aboveNLabel.textContent="N",this._aboveELabel.textContent="E",this._aboveWLabel.textContent="W",this._aboveSLabel.textContent="S",this._belowNLabel.textContent="N",this._belowELabel.textContent="E",this._belowWLabel.textContent="W",this._belowSLabel.textContent="S"),this._currHorizonPlaneLabelsState=i),this._globeSphere.latitudeCircle.setParameters({alt:this._latitude,az:0,tilt:0}),this._transitionIsInOrientationPhase){const t=180+this._transitionPhaseParameter*(this._latitude+90-180),e=this._transitionPhaseParameter*(this._latitude-90),i=this._transitionPhaseParameter*(90-this._latitude),s=90+this._transitionPhaseParameter*(180-this._latitude-90),n=90-this._transitionPhaseParameter*(90-this._latitude);this._latitude<0?(this._globeSphereObj.setPosition({x:0,y:0,z:-.001,system:"horizon"}),this._sphere.meridianCircle1.setParameters({alt:0,az:180,tilt:90,gammaStart:e,gammaEnd:t}),n<0?this._sphere.meridianCircle2.setParameters({alt:0,az:90,tilt:-n,gammaStart:180,gammaEnd:0}):this._sphere.meridianCircle2.setParameters({alt:0,az:270,tilt:n,gammaStart:0,gammaEnd:180})):(this._globeSphereObj.setPosition({x:0,y:0,z:.001,system:"horizon"}),this._sphere.meridianCircle1.setParameters({alt:0,az:180,tilt:90,gammaStart:e,gammaEnd:t}),this._sphere.meridianCircle2.setParameters({alt:0,az:90,tilt:s,gammaStart:0,gammaEnd:180})),this._sphere.horizonCircle.setParameters({alt:0,az:90,tilt:i})}else this._latitude<0?(this._globeSphereObj.setPosition({x:0,y:0,z:-.001,system:"horizon"}),this._sphere.meridianCircle1.setParameters({alt:0,az:180,tilt:90,gammaStart:this._latitude-90,gammaEnd:this._latitude+90}),this._sphere.meridianCircle2.setParameters({alt:0,az:270,tilt:180+this._latitude,gammaStart:180,gammaEnd:0})):(this._globeSphereObj.setPosition({x:0,y:0,z:.001,system:"horizon"}),this._sphere.meridianCircle1.setParameters({alt:0,az:180,tilt:90,gammaStart:this._latitude-90,gammaEnd:this._latitude+90}),this._sphere.meridianCircle2.setParameters({alt:0,az:90,tilt:180-this._latitude,gammaStart:0,gammaEnd:180})),this._sphere.horizonCircle.setParameters({alt:0,az:90,tilt:90-this._latitude});this._dot.setPosition({az:180,alt:this._latitude}),this._dot.setOrientation({type:"absolute"}),this._needs_updateLatitude=!1}this._needs_updateTangentPlane&&this._updateTangentPlane(),this._globeSphere.update(),this._sphere.update(),null!==this._questions&&this._questions.update()}_updateTangentPlane(){let t,e=this._sphereRadius/100;this._transitionIsInOrientationPhase?t=1-this._transitionPhaseParameter:(e*=1-this._transitionPhaseParameter,t=0),Math.max(.4+.3*e,1),this._tangentPlaneAboveElement.setAttribute("transform","scale("+e+")"),this._tangentPlaneAboveElement.setAttribute("opacity",1),this._tangentPlaneBelowElement.setAttribute("transform","scale("+e+")"),this._tangentPlaneBelowElement.setAttribute("opacity",1);const i=this._stickmanScaleMultiplier*e;this._stickmanElement.setAttribute("transform","scale("+i+")");let s=this._globeRadius/this._sphereRadius;const n=1e-4,h=s<n;h&&(s=-n);let a={az:180,alt:this._latitude,r:s},r={};this._sphere.parsePointInput(a,r),Math.sqrt(r.x*r.x+r.y*r.y+r.z*r.z),this._tangentPlaneAbove.setPosition(r),h?r.z+=n:(a.r+=n,this._sphere.parsePointInput(a,r)),this._stickman.setPosition(r);const _=(this._latitude+t*(90-this._latitude))*Math.PI/180,o=.5*Math.PI-_,l={x:-Math.sin(o),y:0,z:Math.cos(o),system:"horizon"},d={x:Math.sin(_),y:0,z:Math.cos(_),system:"horizon"};this._tangentPlaneAbove.setOrientation({type:"absolute",up:d,normal:l}),this._stickman.setOrientation({type:"skewed",up:l}),this._needs_updateTangentPlane=!1}_updateSphereLatitude(){let t;this._needs_updateTangentPlane=!0,this._needs_updateLatitude=!0,t=this._transitionIsInOrientationPhase?this._latitude+this._transitionPhaseParameter*(90-this._latitude):90,this._sphere.setLatitude(t),this._sphereLatitude=t,this._needs_updateSphereLatitude=!1}_updateTransition(){this._needs_updateTangentPlane=!0,this._needs_updateSphereLatitude=!0;const t=1-.8*this._transitionParameter,e=.2+.8*this._transitionParameter;let i,s;this._celestialLabel.style.opacity=e,this._horizonLabel.style.opacity=t,this._horizonArrowHorizontal.style.opacity=t,this._horizonArrowVertical.style.opacity=t,this._celestialArrowHorizontal.style.opacity=e,this._celestialArrowVertical.style.opacity=e,this._transitionIsInOrientationPhase?(s=0,i=this._latitude):(s=this._transitionPhaseParameter*this._globeMaxRadius,i=90),s<1?s=0:(this._globeSphere.setRadius(s),this._dotElement.setAttribute("r",.07*s),this._dotElement.setAttribute("stroke-width",.01*s)),0!==this._globeRadius&&0===s?(this._globeSphereObj.setIsVisible(!1),this._dot.setIsVisible(!1)):0===this._globeRadius&&0!==s&&(this._globeSphereObj.setIsVisible(!0),this._dot.setIsVisible(!0)),this._globeRadius=s,this._needs_updateTransition=!1}},console.info("Celestial Horizon Switcher, 2022-01-25")})()})();